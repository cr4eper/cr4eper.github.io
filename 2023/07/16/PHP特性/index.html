<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>PHP特性 | 阿巴</title><meta name="author" content="阿巴"><meta name="copyright" content="阿巴"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="[TOC] PHP特性php松散比较表：PHP: PHP 类型比较表 - Manual 0.基本弱类型 数组比较：在php手册中写道，当数组(array)与任何非数组进行比较时，数组总是最大的，所以有以下结果“ var_dump([]&gt;0); &#x2F;&#x2F;bool(true) var_dump([]&gt;9999); &#x2F;&#x2F;bool(true) var_d">
<meta property="og:type" content="article">
<meta property="og:title" content="PHP特性">
<meta property="og:url" content="http://example.com/2023/07/16/PHP%E7%89%B9%E6%80%A7/index.html">
<meta property="og:site_name" content="阿巴">
<meta property="og:description" content="[TOC] PHP特性php松散比较表：PHP: PHP 类型比较表 - Manual 0.基本弱类型 数组比较：在php手册中写道，当数组(array)与任何非数组进行比较时，数组总是最大的，所以有以下结果“ var_dump([]&gt;0); &#x2F;&#x2F;bool(true) var_dump([]&gt;9999); &#x2F;&#x2F;bool(true) var_d">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2023-07-16T06:35:17.000Z">
<meta property="article:modified_time" content="2023-09-29T09:06:13.052Z">
<meta property="article:author" content="阿巴">
<meta property="article:tag" content="web安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/07/16/PHP%E7%89%B9%E6%80%A7/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'PHP特性',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-09-29 17:06:13'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">65</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="阿巴"><span class="site-name">阿巴</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">PHP特性</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-07-16T06:35:17.000Z" title="Created 2023-07-16 14:35:17">2023-07-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-09-29T09:06:13.052Z" title="Updated 2023-09-29 17:06:13">2023-09-29</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="PHP特性"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><span id="more"></span>

<p>[TOC]</p>
<h1 id="PHP特性"><a href="#PHP特性" class="headerlink" title="PHP特性"></a>PHP特性</h1><p>php松散比较表：<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/types.comparisons.php">PHP: PHP 类型比较表 - Manual</a></p>
<h2 id="0-基本弱类型"><a href="#0-基本弱类型" class="headerlink" title="0.基本弱类型"></a>0.基本弱类型</h2><ol>
<li><p>数组比较：在php手册中写道，当数组(array)与任何非数组进行比较时，数组总是最大的，所以有以下结果“</p>
<pre class="line-numbers language-none"><code class="language-none">var_dump([]&gt;0); &#x2F;&#x2F;bool(true)
var_dump([]&gt;9999); &#x2F;&#x2F;bool(true)
var_dump([]&gt;&#39;a&#39;); &#x2F;&#x2F;bool(true) #数组大于字符串
var_dump([[]]&gt;[]); &#x2F;&#x2F;bool(true) #自然二位数组大于一维数组<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>bool类型的true比较* bool类型的true跟任意字符可以弱类型相等</p>
</li>
</ol>
   <pre class="line-numbers language-none"><code class="language-none">var_dump(true &#x3D;&#x3D; &#39;a&#39;); &#x2F;&#x2F;bool(true)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="3">
<li><p><code>==</code>与<code>===</code>的区别：</p>
<ul>
<li><p><code>==</code>在进行比较时，向将两边的类型转化成相同类型再进行比较，如果涉及到数值内容的字符串，则字符串会被转化成数值（通过<code>intval()</code> 函数），并且按照数值大小进行比较（<code>&gt;</code>、<code>&lt;</code>同理）。 <strong>补充</strong>： - “根据php手册中所讲，字符串的开头决定了它转换后的值，如果该字符串以合法的数值开始，则使用该合法数值，否则其值为0” - 如果字符创中没有包含<code>.</code>、<code>e</code>、<code>E</code>并且其数值在整形范围内，该字符被当做int来取值，其他所有情况都被作为float来取值。 - 0e开头的字符串被认为是科学技术计数法，且0e开头的数值为0 - 当一个整形与其他类型进行比较时，会先把其他类型进行<code>intval()</code>后再进行比较 所以有如下结果：</p>
<pre class="line-numbers language-none"><code class="language-none">var_dump(1 &#x3D;&#x3D; &#39;1&#39;); &#x2F;&#x2F;bool(true)
var_dump(1 &#x3D;&#x3D; &#39;1a&#39;); &#x2F;&#x2F;bool(true)
var_dump(0 &#x3D;&#x3D; &#39;0exxx&#39;); &#x2F;&#x2F;bool(true)
var_dump(0 &#x3D;&#x3D; &#39;a1&#39;); &#x2F;&#x2F;bool(true)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li></li>
</ul>
</li>
<li><p><code>strcmp()</code>、<code>strcasecmp()</code>函数* <code>strcmp(string1, string2)</code>、<code>strcasecmp(string1, string2)</code> 比较两个字</p>
</li>
</ol>
<p>   符串，前者不区分大小写，后者区分大小写。若<code>string1 &gt; string2</code>，返回<code>&gt; 0</code>；若<code>string1 &lt; string2</code>，返回&#96;&lt;</p>
<p>   0<code>;若</code>string1 &#x3D; string2<code>，返回</code>0<code>。然而该函数无法处理数组，当出现数组时，返回</code>null&#96;。(下例中@表示忽略警</p>
<p>   告)：</p>
   <pre class="line-numbers language-none"><code class="language-none">var_dump(@strcmp([],1));                &#x2F;&#x2F;NULL
var_dump(@strcmp([],&#39;flag&#39;) &#x3D;&#x3D; 0);    &#x2F;&#x2F;bool(true)
var_dump(@strcmp([],&#39;flag&#39;) &#x3D;&#x3D;&#x3D; 0);    &#x2F;&#x2F;bool(false)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="5">
<li><p><code>switch()</code>函数* switch()语句用于根据多个不同的条件执行不同的动作。</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$n</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'2a'</span><span class="token punctuation">;</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token variable">$n</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>
          <span class="token keyword">echo</span> <span class="token string single-quoted-string">'yes'</span><span class="token punctuation">;</span>          
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span>
          <span class="token keyword">echo</span> <span class="token string single-quoted-string">'no'</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>此例中，为数值类型的case，switch会将参数转换为数值（此处可理解为通过&#x3D;&#x3D;进行比较。）。</p>
</li>
</ol>
<h2 id="1-元字符"><a href="#1-元字符" class="headerlink" title="1.元字符"></a>1.元字符</h2><p><img src="/images/PHP%E7%89%B9%E6%80%A7/php%E7%89%B9%E6%80%A7-16902013667631.png"></p>
<p>关于正则表达式的详细介绍见：<a target="_blank" rel="noopener" href="https://www.runoob.com/regexp/regexp-metachar.html">正则表达式 – 元字符 | 菜鸟教程 (runoob.com)</a>。</p>
<h2 id="2-模式修正符："><a href="#2-模式修正符：" class="headerlink" title="2.模式修正符："></a>2.模式修正符：</h2><p><img src="/images/PHP%E7%89%B9%E6%80%A7/php%E7%89%B9%E6%80%A71-16902013871722.png"></p>
<p>对于模式修正符的介绍与使用见：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_54646993/article/details/116097222%E3%80%82">https://blog.csdn.net/weixin_54646993/article/details/116097222。</a></p>
<h2 id="3-preg-match-函数"><a href="#3-preg-match-函数" class="headerlink" title="3.preg_match()函数"></a>3.preg_match()函数</h2><p>该函数用于执行一个正则表达式匹配，语法如下：</p>
<pre class="line-numbers language-none"><code class="language-none">int preg_match ( string $pattern , string $subject [, array &amp;$matches [, int $flags &#x3D; 0 [, int $offset &#x3D; 0 ]]] )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>参数说明：</p>
<ul>
<li>$pattern: 要搜索的模式，字符串形式。</li>
<li>$subject: 输入字符串。</li>
<li>$matches: 如果提供了参数matches，它将被填充为搜索结果。 $matches[0]将包含完整模式匹配到的文本， $matches[1] 将包含第一个捕获子组匹配到的文本，以此类推。</li>
<li>$flags：flags 可以被设置为以下标记值：<ol>
<li>PREG_OFFSET_CAPTURE: 如果传递了这个标记，对于每一个出现的匹配返回时会附加字符串偏移量(相对于目标字符串的)。 注意：这会改变填充到matches参数的数组，使其每个元素成为一个由 第0个元素是匹配到的字符串，第1个元素是该匹配字符串 在目标字符串subject中的偏移量。</li>
</ol>
</li>
<li>offset: 通常，搜索从目标字符串的开始位置开始。可选参数 offset 用于 指定从目标字符串的某个未知开始搜索(单位是字节)。</li>
</ul>
<p>返回 pattern 的匹配次数。 它的值将是 0 次（不匹配）或 1 次，因为 preg_match() 在第一次匹配后 将会停止搜索。preg_match_all() 不同于此，它会一直搜索subject 直到到达结尾。 如果发生错误preg_match()返回 FALSE</p>
<p><strong>绕过方式</strong></p>
<ul>
<li><p>数组绕过：该函数只能处理字符串，当传入的字符串为数组时会返回false；如下例</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当我们传入的字符串为 <code>num[]=1</code> 时便可以成功绕过。</p>
</li>
<li><p>换行绕过：在部分的情况下，换行可以不被匹配到，如：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^php$/im'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^php$/i'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当我们传入的值为 <code>a=%0aphp</code> 时，关键字php就不会被匹配到</p>
</li>
<li><p>最大回溯次数绕过：PHP 为了防止正则表达式的拒绝服务攻击（reDOS），给 pcre 设定了一个回溯次数上限 pcre.backtrack_limit<br>回溯次数上限默认是 100 万。如果回溯次数超过了 100 万，preg_match 将不再返回非 1 和 0，而是 false。</p>
<p>基于这个特性，我们可以编写脚本来使它超过他的默认上限；如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?ctfshow/is'</span><span class="token punctuation">,</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>对于这段代码，我们可以有一下脚本：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
url<span class="token operator">=</span><span class="token string">"http://15bdcf89-9e10-4205-b3b4-6b3a0e45651a.chall.ctf.show:8080/"</span>
data<span class="token operator">=</span><span class="token punctuation">&#123;</span>
	<span class="token string">'f'</span><span class="token punctuation">:</span><span class="token string">'very'</span><span class="token operator">*</span><span class="token number">250000</span><span class="token operator">+</span><span class="token string">'ctfshow'</span>
<span class="token punctuation">&#125;</span>
r<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>便可以成功绕过。</p>
</li>
</ul>
<h2 id="4-intval-函数"><a href="#4-intval-函数" class="headerlink" title="4.intval()函数"></a>4.intval()函数</h2><p>该函数用于获取变量的整数值，<strong>intval()</strong> 函数通过使用指定的进制 base 转换（默认是十进制），返回变量 var 的 integer 数值。 intval() 不能用于 object，否则会产生 E_NOTICE 错误并返回 1。语法如下：</p>
<p><code>int intval ( mixed $var [, int $base = 10 ] )</code></p>
<p>参数解释：</p>
<p>参数说明：</p>
<ul>
<li>$var：要转换成 integer 的数量值。</li>
<li>$base：转化所使用的进制。</li>
</ul>
<p>如果 base 是 0，通过检测 var 的格式来决定使用的进制：</p>
<ul>
<li>如果字符串包括了 “0x” (或 “0X”) 的前缀，使用 16 进制 (hex)；否则，</li>
<li>如果字符串以 “0” 开始，使用 8 进制(octal)；否则，</li>
<li>将使用 10 进制 (decimal)。</li>
</ul>
<p><strong>绕过方法</strong></p>
<ul>
<li><p>字符绕过：intval()而言，如果参数是字符串，则返回字符串中第一个不是数字的字符之前的数字串所代表的整数值。如果字符串第一个是‘-’，则从第二个开始算起。如下面的题：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token number">.0</span>if<span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这个时候我们便可以在数字之后加一个字母，便可以成功绕过 <code>num=4467a</code> 便可以成功绕过。</p>
</li>
<li><p>科学计数法绕过：intval()int函数如果b a s e 为 0 则 base为0则base为0则var中存在字母的话遇到字母就停止读取 但是e这个字母比较特殊，可以在PHP中表示科学计数法。</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在这个情况下，我们可以通过字母e来绕过；如<code>num=4476e1</code>便可以成功绕过。</p>
</li>
<li><p>进制转换绕过：通过对数字的进制转换，来进行绕过。以上面的代码例题为例，我们将4476改为八进制的10574，但是不能直接加，需要在前面加上0，下面是数字的格式:</p>
<p>0b?? : 二进制<br>0??? : 八进制<br>0X?? : 十六进制</p>
</li>
<li><p>小数点的绕过：加小数点改变数据类型，便可以成功绕过：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">===</span><span class="token string double-quoted-string">"4476"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]/i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这道题在上边的基础上加了一个0的过滤，故无法用进制转换绕过，只能通过小数点，使得intval()转变为int()；所以我们传数字<code>num=4476.0</code></p>
</li>
<li><p>左移绕过：通过位运算符<code>&lt;&lt;</code>和<code>&gt;&gt;</code>，我们可以控制数的大小，用法如下：</p>
<ul>
<li><p>“&lt;&lt;” 左移运算符：将一个数的二进制表示向左移动指定的位数，右侧用零填充。移位后的数相当于乘以2的移动的位数次幂。</p>
<p>示例：</p>
<pre class="line-numbers language-none"><code class="language-none">$num &#x3D; 5;  &#x2F;&#x2F; 二进制表示为 00000101
$result &#x3D; $num &lt;&lt; 2;  &#x2F;&#x2F; 向左移动2位
echo $result;  &#x2F;&#x2F; 输出 20，相当于 5 * (2的2次幂) &#x3D; 20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>“&gt;&gt;” 右移运算符：将一个数的二进制表示向右移动指定的位数，左侧用符号位填充（即对于正数用0填充，对于负数用1填充）。移位后的数相当于除以2的移动的位数次幂。</p>
<p>示例：</p>
<pre class="line-numbers language-none"><code class="language-none">$num &#x3D; 16;  &#x2F;&#x2F; 二进制表示为 00010000
$result &#x3D; $num &gt;&gt; 2;  &#x2F;&#x2F; 向右移动2位
echo $result;  &#x2F;&#x2F; 输出 4，相当于 16 &#x2F; (2的2次幂) &#x3D; 4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p>如下例题：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment"># 包含数据库连接文件</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"config.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 判断get提交的参数id是否存在</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/or|\+/i"</span><span class="token punctuation">,</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"id error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment"># 判断id的值是否大于999</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment"># id 大于 999 直接退出并返回错误</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"id error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token comment"># id 小于 999 拼接sql语句</span>
        <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select * from article where id = <span class="token interpolation"><span class="token variable">$id</span></span> order by id limit 1 "</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"执行的sql为：<span class="token interpolation"><span class="token variable">$sql</span></span>&lt;br>"</span><span class="token punctuation">;</span>
        <span class="token comment"># 执行sql 语句</span>
        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment"># 判断有没有查询结果</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment"># 如果有结果，获取结果对象的值$row</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"id: "</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">]</span><span class="token operator">.</span> <span class="token string double-quoted-string">" - title: "</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"title"</span><span class="token punctuation">]</span><span class="token operator">.</span> <span class="token string double-quoted-string">" &lt;br>&lt;hr>"</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"content"</span><span class="token punctuation">]</span><span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment"># 关闭数据库连接</span>
        <span class="token variable">$conn</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在这个题目当中，目标id&#x3D;1000，我们要绕过intval()函数，该函数使用前几种方法的值大小都不会改变，但由于该函数有<strong>intval()而言，如果参数是字符串，则返回字符串中第一个不是数字的字符之前的数字串所代表的整数值</strong>此条性质，我们便可以将<code>id=%0a125&lt;&lt;3</code>，此时，该函数读取到的数是123，但该数实际值却是1000，这样，便可以成功绕过。</p>
</li>
<li><p>按位或和按位异或绕过：</p>
<ul>
<li><p>按位或：</p>
<p>按位或（|）是一种二进制的逻辑操作符，针对两个二进制数的对应位进行比较，只要有一个位上的数为1，结果就为1。其真值表如下：</p>
<pre class="line-numbers language-none"><code class="language-none">0 | 0 &#x3D; 0
0 | 1 &#x3D; 1
1 | 0 &#x3D; 1
1 | 1 &#x3D; 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>例如，将十进制数5（二进制表示为101）与十进制数3（二进制表示为011）进行按位或运算，结果为7（二进制表示为111）。</p>
</li>
<li><p>按位异或：</p>
<p>按位异或（^）也是一种二进制的逻辑操作符，针对两个二进制数的对应位进行比较，只有在两个位上的数不同时，结果才为1。其真值表如下：</p>
<pre class="line-numbers language-none"><code class="language-none">0 ^ 0 &#x3D; 0
0 ^ 1 &#x3D; 1
1 ^ 0 &#x3D; 1
1 ^ 1 &#x3D; 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>例如，将十进制数5（二进制表示为101）与十进制数3（二进制表示为011）进行按位异或运算，结果为6（二进制表示为110）。</p>
</li>
</ul>
</li>
</ul>
<h2 id="5-strpos-函数"><a href="#5-strpos-函数" class="headerlink" title="5.strpos()函数"></a>5.strpos()函数</h2><p>此函数是查询某字符在字符串中第一次出现的位置，且区分大小写，语法格式如下：</p>
<p><code>strpos(string,find,start)</code></p>
<p>参数解释：string	必需。规定要搜索的字符串。find	必需。规定要查找的字符串。start	可选。规定在何处开始搜索。</p>
<table>
<thead>
<tr>
<th>返回值：</th>
<th>返回字符串在另一字符串中第一次出现的位置，如果没有找到字符串则返回 FALSE。<strong>注释：</strong>字符串位置从 0 开始，不是从 1 开始。</th>
</tr>
</thead>
<tbody><tr>
<td>PHP 版本：</td>
<td>4+</td>
</tr>
</tbody></table>
<p>相关函数：</p>
<pre class="line-numbers language-none"><code class="language-none">stripos() - 查找字符串在另一字符串中第一次出现的位置（不区分大小写）
strripos() - 查找字符串在另一字符串中最后一次出现的位置（不区分大小写）
strrpos() - 查找字符串在另一字符串中最后一次出现的位置（区分大小写）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>绕过方法</strong></p>
<ul>
<li><p>数组绕过：strpos如果接收了数组作为参数，那么就会返回null。基于这个原理我们可以通过数组来绕过此函数，如下</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"flag"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'#biubiubiu'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Flag: '</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'骚年，继续努力吧啊~'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>此时需要该函数的返回值不等于FALSE，故我们直接输入<code>?ctf[]</code>将该参数直接设为数组，该返回值为NULL，便可成功绕过。</p>
</li>
<li><p>根据逻辑关系直接绕过：这种情况出现较少，在遇到题目之后再做记录。</p>
</li>
<li><p>可以通过符号截断绕过，也可以通过科学计数法字母e来绕过</p>
</li>
</ul>
<h2 id="6-MD5和sha1-函数"><a href="#6-MD5和sha1-函数" class="headerlink" title="6.MD5和sha1()函数"></a>6.MD5和sha1()函数</h2><h3 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h3><p>该函数用于将一字符串进行md5编码后输出，语法格式如下：</p>
<p><code>md5(string,raw)</code></p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><em>string</em></td>
<td align="left">必需。规定要计算的字符串。</td>
</tr>
<tr>
<td align="left"><em>raw</em></td>
<td align="left">可选。规定十六进制或二进制输出格式：TRUE - 原始 16 字符二进制格式FALSE - 默认。32 字符十六进制数</td>
</tr>
</tbody></table>
<p>返回值如下：</p>
<table>
<thead>
<tr>
<th>返回值：</th>
<th>如果成功则返回已计算的 MD5 散列，如果失败则返回 FALSE。</th>
</tr>
</thead>
<tbody><tr>
<td>PHP 版本：</td>
<td>4+</td>
</tr>
<tr>
<td>更新日志：</td>
<td>在 PHP 5.0 中，<em>raw</em> 参数变为可选的。</td>
</tr>
</tbody></table>
<p><strong>绕过方法</strong>：</p>
<ul>
<li><p>数组绕过：将需要我们传入的数据设置为数组，在此种情况下，会产生报错，但返回值为真：</p>
<p><img src="/images/PHP%E7%89%B9%E6%80%A7/md5%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87-16902014284863.png"></p>
<p>在此题目当中，可以得到NULL&#x3D;&#x3D;NULL，便可以成功绕过。（注意：假如对参数进行了过滤，此种方法便不再可行。）</p>
</li>
<li><p>常规的0e绕过：”0e”绕过是指通过寻找特定输入，使其MD5值以”0e”开头，后跟一系列数字，同时该MD5值被解释为科学计数法中的0乘以10的指数，也就是成为<code>0=0</code>，便可以绕过。这可能导致验证代码中的类型转换错误，从而导致绕过某些安全检查；常见开头为0e的md5值的字符串有以下：</p>
<ul>
<li>QNKCDZO</li>
<li>240610708</li>
<li>s878926199a</li>
<li>s155964671a</li>
<li>s214587387a</li>
<li>s214587387a</li>
</ul>
<p>这些字符串的 md5 值都是 0e 开头，在 php 弱类型比较中判断为相等。（注意：此种方法仅适用弱比较情况，在强比较情况下不能使用）</p>
</li>
<li><p>md5碰撞绕过绕过：输入两个不同的哈希值，使其经转换过后的值相同，同样可以成功绕过。</p>
</li>
<li><p>MySQL注入绕过：ffifdyop 的MD5加密结果是 276f722736c95d99e921722cf9ed621c</p>
<p>经过MySQL编码后会变成’or’6xxx,使SQL恒成立,相当于万能密码,可以绕过md5()函数的加密</p>
</li>
</ul>
<h3 id="sha1-函数"><a href="#sha1-函数" class="headerlink" title="sha1()函数"></a>sha1()函数</h3><p>sha()函数大致与md5函数相同，同样无法处理数组，遇到数组会警告并返回NULL，0e同样可以绕过该函数，也同样可以MySQL注入，但与md5函数的不同；下列是sha1()函数的0e绕过的特殊数</p>
<pre class="line-numbers language-none"><code class="language-none">sha1(&#39;aaroZmOk&#39;) &#x2F;&#x2F;0e66507019969427134894567494305185566735
sha1(&#39;aaK1STfY&#39;) &#x2F;&#x2F;0e76658526655756207688271159624026011393
sha1(&#39;aaO8zKZF&#39;) &#x2F;&#x2F;0e89257456677279068558073954252716165668
sha1(&#39;aa3OFF9m&#39;) &#x2F;&#x2F;0e36977786278517984959260394024281014729<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="7-file-put-contents-函数"><a href="#7-file-put-contents-函数" class="headerlink" title="7.file_put_contents()函数"></a>7.file_put_contents()函数</h2><p>该函数把一个字符串写入文件中。</p>
<p>该函数访问文件时，遵循以下规则：</p>
<ol>
<li>如果设置了 FILE_USE_INCLUDE_PATH，那么将检查 <em>filename</em> 副本的内置路径</li>
<li>如果文件不存在，将创建一个文件</li>
<li>打开文件</li>
<li>如果设置了 LOCK_EX，那么将锁定文件</li>
<li>如果设置了 FILE_APPEND，那么将移至文件末尾。否则，将会清除文件的内容</li>
<li>向文件中写入数据</li>
<li>关闭文件并对所有文件解锁</li>
</ol>
<p>如果成功，该函数将返回写入文件中的字符数。如果失败，则返回 False。语法如下：</p>
<p><code>int file_put_contents ( string $filename , mixed $data [, int $flags = 0 [, resource $context ]] )</code></p>
<p>参数如下：</p>
<table>
<thead>
<tr>
<th align="center">参数</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">filename</td>
<td align="center">必需。规定要写入数据的文件。如果文件不存在，则创建一个新文件。</td>
</tr>
<tr>
<td align="center">data</td>
<td align="center">必需。规定要写入文件的数据。可以是字符串、数组或数据流。</td>
</tr>
<tr>
<td align="center">flags</td>
<td align="center">可选。规定如何打开&#x2F;写入文件。可能的值：FILE_USE_INCLUDE_PATHFILE_APPENDLOCK_EX</td>
</tr>
<tr>
<td align="center">context</td>
<td align="center">可选。规定文件句柄的环境。context 是一套可以修改流的行为的选项。</td>
</tr>
</tbody></table>
<p>该函数访问文件时，遵循以下规则：</p>
<p>如果设置了 FILE_USE_INCLUDE_PATH，那么将检查 filename 副本的内置路径 如果文件不存在，将创建一个文件<br>打开文件 如果设置了 LOCK_EX，那么将锁定文件 如果设置了 FILE_APPEND，那么将移至文件末尾。否则，将会清除文件的内容<br>向文件中写入数据 关闭文件并对所有文件解锁 如果成功，该函数将返回写入文件中的字符数。如果失败，则返回 False。</p>
<h2 id="8-in-array-函数"><a href="#8-in-array-函数" class="headerlink" title="8.in_array()函数"></a>8.in_array()函数</h2><p>该函数搜索数组中是否存在指定的值。语法如下：</p>
<p><code>bool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] )</code></p>
<p>参数解释：</p>
<table>
<thead>
<tr>
<th align="center">参数</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><em>needle</em></td>
<td align="center">必需。规定要在数组搜索的值。</td>
</tr>
<tr>
<td align="center"><em>haystack</em></td>
<td align="center">必需。规定要搜索的数组。</td>
</tr>
<tr>
<td align="center"><em>strict</em></td>
<td align="center">可选。如果该参数设置为 TRUE，则 in_array() 函数检查搜索的数据与数组的值的类型是否相同。</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">返回值：</th>
<th align="center">如果在数组中找到值则返回 TRUE，否则返回 FALSE。</th>
</tr>
</thead>
<tbody><tr>
<td align="center">PHP 版本：</td>
<td align="center">4+</td>
</tr>
<tr>
<td align="center">更新日志</td>
<td align="center">自 PHP 4.2 起，search 参数可以是一个数组。</td>
</tr>
</tbody></table>
<p><strong>绕过方法</strong>：</p>
<p>在 <strong>$haystack</strong> 中搜索 <strong>$needle</strong> ，如果第三个参数 <strong>$strict</strong> 的值为 <strong>TRUE</strong> ，则 <strong>in_array()</strong> 函数会进行强检查，检查 <strong>$needle</strong> 的类型是否和 <strong>$haystack</strong> 中的相同。如果找到 <strong>$haystack</strong> ，则返回 <strong>TRUE</strong>，否则返回 <strong>FALSE</strong>。通过这个性质，我们便可以绕过部分情况：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Challenge</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token constant">UPLOAD_DIRECTORY</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'./solutions/'</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$whitelist</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">whitelist</span> <span class="token operator">=</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span>
                <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token constant">UPLOAD_DIRECTORY</span> <span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$challenge</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Challenge</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'solution'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在这段代码当中，由于该函数并未将第三个参数设置为 true ，这导致攻击者可以通过构造的文件名来绕过服务端的检测，例如文件名为 7shell.php 。因为PHP在使用 in_array() 函数判断时，会将 7shell.php 强制转换成数字7，而数字7在 range(1,24) 数组中，最终绕过 in_array() 函数判断，导致任意文件上传漏洞。（这里之所以会发生强制类型转换，是因为目标数组中的元素为数字类型）</p>
<h2 id="9-优先级"><a href="#9-优先级" class="headerlink" title="9.优先级"></a>9.优先级</h2><ul>
<li><p>符号：优先级情况如下图：</p>
<table>
<thead>
<tr>
<th align="center"><strong>优先级</strong></th>
<th align="center"><strong>结合方向</strong></th>
<th align="center"><strong>运算符</strong></th>
<th align="center"><strong>附加信息</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">无结合</td>
<td align="center">clone、new</td>
<td align="center">clone 和 new</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">从右向左</td>
<td align="center">**</td>
<td align="center">算术运算符</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">从右向左</td>
<td align="center">++、–、~、(int)、(float)、(string)、(array)、(object)、(bool)、@</td>
<td align="center">类型、递增／递减、错误控制</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">无结合</td>
<td align="center">instanceof</td>
<td align="center">类型</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">从右向左</td>
<td align="center">!</td>
<td align="center">逻辑运算符</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">从左向右</td>
<td align="center">*、&#x2F;、%</td>
<td align="center">算术运算符</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">从左向右</td>
<td align="center">+、-、.</td>
<td align="center">算术运算符和字符串运算符</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">从左向右</td>
<td align="center">&lt;&lt;、&gt;&gt;</td>
<td align="center">位运算符</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">无结合</td>
<td align="center">&lt;、&lt;&#x3D;、&gt;、&gt;&#x3D;</td>
<td align="center">比较运算符</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">无结合</td>
<td align="center">&#x3D;&#x3D;、!&#x3D;、&#x3D;&#x3D;&#x3D;、!&#x3D;&#x3D;、&lt;&gt;、&lt;&#x3D;&gt;</td>
<td align="center">比较运算符</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">从左向右</td>
<td align="center">&amp;</td>
<td align="center">位运算符和引用</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">从左向右</td>
<td align="center">^</td>
<td align="center">位运算符</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">从左向右</td>
<td align="center">|</td>
<td align="center">位运算符</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">从左向右</td>
<td align="center">&amp;&amp;</td>
<td align="center">逻辑运算符</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">从左向右</td>
<td align="center">||</td>
<td align="center">逻辑运算符</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">从右向左</td>
<td align="center">??</td>
<td align="center">null 合并运算符</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">从左向右</td>
<td align="center">? :</td>
<td align="center">三元运算符</td>
</tr>
<tr>
<td align="center">18</td>
<td align="center">从右向左</td>
<td align="center">&#x3D;、+&#x3D;、-&#x3D;、*&#x3D;、**&#x3D;、&#x2F;&#x3D;、.&#x3D;、%&#x3D;、&amp;&#x3D;、|&#x3D;、^&#x3D;、&lt;&lt;&#x3D;、&gt;&gt;&#x3D;</td>
<td align="center">赋值运算符</td>
</tr>
<tr>
<td align="center">19</td>
<td align="center">从左向右</td>
<td align="center">and</td>
<td align="center">逻辑运算符</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">从左向右</td>
<td align="center">xor</td>
<td align="center">逻辑运算符</td>
</tr>
<tr>
<td align="center">21</td>
<td align="center">从左向右</td>
<td align="center">or</td>
<td align="center">逻辑运算符</td>
</tr>
</tbody></table>
<p>如下例所示：&amp;&amp;与||的优先级高于&#x3D;，&#x3D;的优先级高于and与or</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
   	<span class="token operator">...</span><span class="token operator">...</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>在此时，我们只需令v1&#x3D;数字，v0就为true，便可成功绕过。</p>
</li>
<li><p>get与post：http协议默认先以get方式获取数据，无论是否以哪种方式发起的，总是get方式优先，即通过get方式获取到了数据就不会再去通过post方式获取一遍，如果get方式获取不到，再以post方式获取。</p>
</li>
</ul>
<h2 id="10-ReflectionClass反射类"><a href="#10-ReflectionClass反射类" class="headerlink" title="10.ReflectionClass反射类"></a>10.ReflectionClass反射类</h2><p>PHP中的扩展反射类，该扩展用来分析php程序，导出或提取出关于类、方法、属性、参数等的详细信息，包括注释</p>
<h2 id="11-is-numeric-函数"><a href="#11-is-numeric-函数" class="headerlink" title="11.is_numeric()函数"></a>11.is_numeric()函数</h2><p><strong>is_numeric()</strong> 函数用于检测变量是否为数字或数字字符串。语法如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">bool</span> <span class="token function">is_numeric</span> <span class="token punctuation">(</span> <span class="token keyword type-hint">mixed</span> <span class="token variable">$var</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>$var：要检测的变量。</p>
<p>返回值：如果指定的变量是数字和数字字符串则返回 TRUE，否则返回 FALSE。</p>
<p>特点：括号中的值会被弱类型替换。</p>
<p>示例：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$var_name1</span><span class="token operator">=</span><span class="token number">678</span><span class="token punctuation">;</span>
<span class="token variable">$var_name2</span><span class="token operator">=</span><span class="token string double-quoted-string">"a678"</span><span class="token punctuation">;</span>
<span class="token variable">$var_name3</span><span class="token operator">=</span><span class="token string double-quoted-string">"678"</span><span class="token punctuation">;</span>
<span class="token variable">$var_name4</span><span class="token operator">=</span><span class="token string double-quoted-string">"runoob.com"</span><span class="token punctuation">;</span>
<span class="token variable">$var_name5</span><span class="token operator">=</span><span class="token number">698.99</span><span class="token punctuation">;</span>
<span class="token variable">$var_name6</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a1"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"a2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$var_name7</span><span class="token operator">=</span><span class="token operator">+</span><span class="token number">125689.66</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$var_name1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$var_name1</span></span> 是数字"</span> <span class="token operator">.</span> <span class="token constant">PHP_EOL</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$var_name1</span></span> 不是数字"</span> <span class="token operator">.</span> <span class="token constant">PHP_EOL</span> <span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$var_name2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$var_name2</span></span> 是数字"</span> <span class="token operator">.</span> <span class="token constant">PHP_EOL</span> <span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$var_name2</span></span> 不是数字"</span> <span class="token operator">.</span> <span class="token constant">PHP_EOL</span> <span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$var_name3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"[ <span class="token interpolation"><span class="token variable">$var_name3</span></span> 是数字吗? ]"</span> <span class="token operator">.</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PHP_EOL</span><span class="token punctuation">;</span>
<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$var_name4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"[ <span class="token interpolation"><span class="token variable">$var_name4</span></span> 是数字吗? ]"</span> <span class="token operator">.</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PHP_EOL</span><span class="token punctuation">;</span>
<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$var_name5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"[ <span class="token interpolation"><span class="token variable">$var_name5</span></span> 是数字吗? ]"</span> <span class="token operator">.</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PHP_EOL</span><span class="token punctuation">;</span>
<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$var_name6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"[ <span class="token interpolation"><span class="token variable">$var_name6</span></span> 是数字吗? ]"</span> <span class="token operator">.</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token constant">PHP_EOL</span><span class="token punctuation">;</span>
<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$var_name7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"[ <span class="token interpolation"><span class="token variable">$var_name7</span></span> 是数字吗? ]"</span> <span class="token operator">.</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>结果如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">678</span> 是数字
a678 不是数字
<span class="token keyword type-declaration">bool</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token number">678</span> 是数字吗<span class="token operator">?</span> <span class="token punctuation">]</span>
<span class="token keyword type-declaration">bool</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> runoob<span class="token operator">.</span>com 是数字吗<span class="token operator">?</span> <span class="token punctuation">]</span>
<span class="token keyword type-declaration">bool</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token number">698.99</span> 是数字吗<span class="token operator">?</span> <span class="token punctuation">]</span>
<span class="token keyword type-declaration">bool</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token keyword type-declaration">Array</span> 是数字吗<span class="token operator">?</span> <span class="token punctuation">]</span>
<span class="token keyword type-declaration">bool</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token number">125689.66</span> 是数字吗<span class="token operator">?</span> <span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这个函数和mysql结合起来就容易出问题，那是因为is_numeric判断的时候，当碰到16进制数的时候，也会判断成数字，is_numeric函数对于空字符%00，无论是%00放在前后都可以判断为非数值，而%20空格字符只能放在数值后。所以，查看函数发现该函数对对于第一个空格字符会跳过空格字符判断，接着后面的判断。在部分情况时，在数字后边接%00也可以成功绕过。</p>
<p>(注意：<code>+</code>号与<code>-</code>在判定时只有在数字前才会被判定为数字，在数字之后会判定为一个字符串，无论你这两个符号后有没有数字，都会被判定为字符串，其他的部分符号也一样，也会有这种特性)</p>
<h2 id="12-call-user-func回调函数"><a href="#12-call-user-func回调函数" class="headerlink" title="12.call_user_func回调函数"></a>12.call_user_func回调函数</h2><p>call_user_func — 把第一个参数作为回调函数调用；回调函数：指的是一个函数作为参数传递给另一个函数，并且可以在后者中被调用执行的函数。语法如下：</p>
<p>call_user_func(<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.types.callable.php">callable</a> <code>$callback</code>, <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.types.declarations.php#language.types.declarations.mixed">mixed</a> <code>...$args</code>): <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.types.declarations.php#language.types.declarations.mixed">mixed</a></p>
<p>参数解释：</p>
<ul>
<li><p><code>callback</code> 是被调用的回调函数，其余参数是回调函数的参数。</p>
</li>
<li><p>callback：将被调用的回调函数（<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.types.callable.php">callable</a>）</p>
</li>
<li><p>args：0个或以上的参数，被传入回调函数</p>
</li>
</ul>
<p>如下例，此函数提供了一种特殊的函数调用方法：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function-definition function">nowamagic</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token variable">$b</span><span class="token punctuation">)</span>   
<span class="token punctuation">&#123;</span>   
    <span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span>   
    <span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span>   
<span class="token punctuation">&#125;</span>   
<span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'nowamagic'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"111"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"222"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
<span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'nowamagic'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"333"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"444"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
<span class="token comment">//显示 111 222 333 444   </span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>调用类内部时，用的是array：****</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">a</span> <span class="token punctuation">&#123;</span>   
    <span class="token keyword">function</span> <span class="token function-definition function">b</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span>   
    <span class="token punctuation">&#123;</span>   
        <span class="token keyword">echo</span> <span class="token variable">$c</span><span class="token punctuation">;</span>   
    <span class="token punctuation">&#125;</span>   
<span class="token punctuation">&#125;</span>   
<span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"111"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
<span class="token comment">//显示 111   </span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="13-php伪协议"><a href="#13-php伪协议" class="headerlink" title="13.php伪协议"></a>13.php伪协议</h2><p>对于php伪协议的详细介绍见<a target="_blank" rel="noopener" href="https://621779.github.io/2023/07/16/RCE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">RCE学习笔记 </a></p>
<p><strong>常见用法</strong></p>
<ol>
<li><p>写文件：</p>
<p>在有file_put_contents(v 3 , v3,v3,str)函数的帮助下，我们可以通过下面这句代码直接写入木马到某文件：</p>
<p><code>v3=php://filter/write=convert.base64-decode/resource=1.php&amp;str=......</code></p>
</li>
<li><p>读文件：</p>
<p>读文件跟写入大致相同，但不需要额外写入write，大致语法如下：</p>
<p><code>php://filter/convert.base64-decode/resource=想读取的文件名</code></p>
<p>部分情况会遇到过滤，看情况绕过即可，对于该协议的详细介绍，见开头的连接文章。</p>
</li>
</ol>
<h2 id="14-is-file-函数"><a href="#14-is-file-函数" class="headerlink" title="14.is_file()函数"></a>14.is_file()函数</h2><p>is_file() 函数检查指定的文件名是否是正常的文件。语法：<code>is_file(file)</code></p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><em>file</em></td>
<td align="left">必需。规定要检查的文件。</td>
</tr>
</tbody></table>
<p>该变量可以为伪协议。</p>
<p>返回值：如果文件存在且为正常的文件，则返回 true。</p>
<p><strong>伪协议绕过</strong></p>
<p>highlight_file()可以识别php伪协议 is_file()不能识别php伪协议，所以我们可以通过为协议来绕过。</p>
<p><strong>目录溢出绕过</strong></p>
<p>在linux中&#x2F;proc&#x2F;self&#x2F;root是指向根目录的 也就是如果在命令行中输入 ls &#x2F;proc&#x2F;self&#x2F;root，其实显示的内容是根目录下的内容 多次重复后绕过is_file。</p>
<pre class="line-numbers language-none"><code class="language-none">file&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="15-parse-str-函数"><a href="#15-parse-str-函数" class="headerlink" title="15.parse_str()函数"></a>15.parse_str()函数</h2><p>把查询字符串解析到变量中,如下例：</p>
<p>有一个url：<code>http://example.com/page.php?name=John&amp;age=25</code>，利用此函数我们便可以将此url当中的变量分开：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$queryString</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"name=John&amp;age=25"</span><span class="token punctuation">;</span>
<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$queryString</span><span class="token punctuation">,</span> <span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token variable">$output</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 输出：John</span>
<span class="token keyword">echo</span> <span class="token variable">$output</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 输出：25</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>语法：<code>parse_str(string,array)</code></p>
<p>变量解释：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><em>string</em></td>
<td align="left">必需。规定要解析的字符串。</td>
</tr>
<tr>
<td align="left"><em>array</em></td>
<td align="left">可选。规定存储变量的数组的名称。该参数指示变量将被存储到数组中。</td>
</tr>
</tbody></table>
<p><strong>注意</strong>：如果未设置 <em>array</em> 参数，则由该函数设置的变量将覆盖已存在的同名变量。php.ini 文件中的 magic_quotes_gpc 设置影响该函数的输出。如果已启用，那么在 parse_str() 解析之前，变量会被 addslashes() 转换。且若要post参数，需加引号。</p>
<p><strong>变量覆盖漏洞</strong></p>
<p>parse_str() 函数用于把查询字符串解析到变量中，如果没有array 参数，则由该函数设置的变量将覆盖已存在的同名变量。 极度不建议 在没有 array参数的情况下使用此函数，并且在 PHP 7.2 中将废弃不设置参数的行为。此函数没有返回值。</p>
<h2 id="16-ereg-截断漏洞"><a href="#16-ereg-截断漏洞" class="headerlink" title="16.ereg()截断漏洞"></a>16.ereg()截断漏洞</h2><p>ereg()函数用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回true,否则,则返回false。搜索字母的字符是大小写敏感的。可选的输入参数规则包含一个数组的所有匹配表达式,他们被正则表达式的括号分组。</p>
<p>语法：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">int</span> <span class="token function">ereg</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span> pattern<span class="token punctuation">,</span> <span class="token keyword type-declaration">string</span> originalstring<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword type-declaration">array</span> regs<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>返回值：</p>
<p>如果有找到模式匹配，则返回<code>true</code>，否则返回<code>false</code>。</p>
<p><strong>绕过方法</strong></p>
<ol>
<li><p>截断绕过：<code>ereg()</code>函数存在NULL截断漏洞，当传入的字符串包含%00时，只有%00前的字符串会传入函数并执行，而后半部分不会传入函数判断。因此可以使用%00截断，连接非法字符串，从而绕过函数。如下例题：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ereg</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"^[a-zA-Z]+$"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//只有36d的人才能看到flag</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在此题目当中，我们需要参数的值是<code>0x36d</code>，要包含字母，而且参数要反向，通过计算：0x36d&#x3D;(877)D，反向后是778，最后使用%00截断即：<code>payload:?c=a%00778</code>。</p>
<p><strong>执行GET请求时会默认进行一次URL解码</strong>，由于%00是一个不可见字符，c的值实际是<code>a(invisible)778</code>。经过<code>ereg()</code>截断，前部分<code>a</code>通过匹配返回1，不会<code>die(&#39;error&#39;)</code>。再反向取值，0x36d比较后部分的<code>877</code>返回1，从而<code>echo $flag</code>。</p>
</li>
</ol>
<h2 id="17-strrev-函数"><a href="#17-strrev-函数" class="headerlink" title="17.strrev()函数"></a>17.strrev()函数</h2><p>strrev()函数把字符串s的所有字符的顺序颠倒过来（不包括空字符NULL），返回指向颠倒顺序后的字符串指针。</p>
<p>语法：<code>strrev(string)</code>，string字符串必须存在</p>
<table>
<thead>
<tr>
<th>返回值：</th>
<th>返回已反转的字符串。</th>
</tr>
</thead>
<tbody><tr>
<td>PHP 版本：</td>
<td>4+</td>
</tr>
</tbody></table>
<p><strong>函数特点</strong></p>
<p>反转字符串，常出现在%00截断漏洞中。这个函数直接使用时不能颠倒例如以下的内容：</p>
<pre class="line-numbers language-objectivec" data-language="objectivec"><code class="language-objectivec"><span class="token keyword">char</span> <span class="token operator">*</span>forward<span class="token operator">=</span><span class="token string">"string"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>注：%00是一个整体，不会反转成00%</p>
<h2 id="18-变量覆盖绕过"><a href="#18-变量覆盖绕过" class="headerlink" title="18.变量覆盖绕过"></a>18.变量覆盖绕过</h2><p><img src="/images/PHP%E7%89%B9%E6%80%A7/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%961.png"></p>
<ul>
<li><p>全局变量覆盖：</p>
<p>register_globals的意思就是注册为全局变量，所以<strong>当为On的时候，传递过来的值会被直接注册为全局变量直接使用，而Off的时候，我们需要到特定的数组里去得到它</strong>。简单来说，就是你定义了一个全局变量，在某个范围当中，你可以将它覆盖为其他值，如你传进来的值：</p>
<pre class="line-numbers language-PHP" data-language="PHP"><code class="language-PHP">$globalVar &#x3D; &quot;Global&quot;;

function test() &#123;
    $localVar &#x3D; &quot;Local&quot;;
    echo $localVar; &#x2F;&#x2F; 输出：Local

    global $globalVar;
    echo $globalVar; &#x2F;&#x2F; 输出：Global

    $globalVar &#x3D; &quot;Modified&quot;;
&#125;

test();
echo $globalVar; &#x2F;&#x2F; 输出：Modified<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如上述代码所示，在function函数当中，lobavar变量的值可以被覆盖。在部分情况会引发漏洞</p>
</li>
<li><p>$$引起的变量覆盖：<br>在PHP中，$$符号是一种变量间接引用的特殊语法。它允许使用一个变量的值作为另一个变量的名称。具体而言，当一个变量名通过$$符号包裹时，PHP将解释为变量名对应的变量的值。如下列代码：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$foo</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"bar"</span><span class="token punctuation">;</span>
<span class="token variable">$bar</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Hello, World!"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$$foo</span><span class="token punctuation">;</span> <span class="token comment">// 输出：Hello, World!</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>extract()函数引起的变量覆盖：</p>
<p>extract() 函数从数组中将变量导入到当前的符号表。该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量。该函数返回成功设置的变量数目。<br><code>extract(array,extract_rules,prefix)</code>实列如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token keyword">echo</span> <span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$age</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$phone</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>

<span class="token comment">//GET传参:?name=xiaohua&amp;age=22&amp;phone=112323123</span>
<span class="token comment">//结果:</span>
<span class="token comment">// xiaohua</span>
<span class="token comment">// 22</span>
<span class="token comment">// 112323123</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>parse_str()函数变量覆盖：</p>
<p>parse_str() 函数把查询字符串解析到变量中。注释：<strong>如果未设置 array 参数，由该函数设置的变量将覆盖已存在的同名变量。</strong>且php.ini 文件中的 magic_quotes_gpc 设置影响该函数的输出。如果已启用，那么在 parse_str() 解析之前，变量会被 addslashes() 转换。</p>
<p><code>parse_str(string,array)</code>   示例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"name=xiaohua&amp;age=22"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$name</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$age</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
//xiaohua
//22<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>import_request_variables()函数变量覆盖：</p>
<p> import_request_variables — 将 GET／POST／Cookie 变量导入到全局作用域中</p>
<p>将 GET／POST／Cookie 变量导入到全局作用域中。如果你禁止了 <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/ini.core.php#ini.register-globals">register_globals</a>，但又想用到一些全局变量，那么此函数就很有用。</p>
<pre class="line-numbers language-none"><code class="language-none">import_request_variables ( string $types [, string $prefix ] ) : bool<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>使用范围：(PHP 4 &gt;&#x3D; 4.1.0, PHP 5 &lt; 5.4.0)。示例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$num</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//include 'flag.php';</span>
<span class="token function">import_request_variables</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'gp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//导入get和post中变量</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token string double-quoted-string">"xiaohua"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'flag&#123; xiaohua-2020-3-28&#125;'</span><span class="token punctuation">;</span>
    <span class="token comment">// echo $flag.php;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"NO!"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> 
//payload：http://127.0.0.1/test.php?num=xiaohua
//flag&#123; xiaohua-2020-3-28&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h2 id="19-Exception异常处理类"><a href="#19-Exception异常处理类" class="headerlink" title="19.Exception异常处理类"></a>19.Exception异常处理类</h2><p>和ReflectionClass反射类用法相似，该类中常用的成员函数如下所示：</p>
<pre class="line-numbers language-none"><code class="language-none">getMessage()：返回异常的消息内容；
getCode()：以数字形式返回异常代码；
getFile()：返回发生异常的文件名；
getLine()：返回发生错误的代码行号；
getTrace()：返回 backtrace() 数组；
getTraceAsString()：返回已格式化成字符串的、由函数 getTrace() 函数所产生的信息；
__toString()：产生异常的字符串信息，它可以重载。注意，该函数最前部是两个下划线。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以和system连用：</p>
<p><code>Reflectionclass(system(&#39;cat </code>ls<code>&#39;));</code></p>
<h2 id="20-FilesystemIterator类读取文件"><a href="#20-FilesystemIterator类读取文件" class="headerlink" title="20.FilesystemIterator类读取文件"></a>20.FilesystemIterator类读取文件</h2><p>FilesystemIterator获取指定目录下的所有文件<br>getcwd()函数：获取当前工作目录 返回当前工作目录</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">FilesystemIterator</span><span class="token punctuation">(</span><span class="token function">getcwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="21-php变量"><a href="#21-php变量" class="headerlink" title="21.php变量"></a>21.php变量</h2><ul>
<li><p>GLOBALS<br>GLOBALS是一个在PHP中预定义的全局变量，它是一个包含全局作用域中的所有全局变量的关联数组。通过GLOBALS数组，可以在函数内部访问和修改全局变量的值。数组的键是变量的名称，值是变量的值。通过GLOBALS数组的键是变量的名称，值是变量的值。通过GLOBALS[‘variable_name’]可以访问全局变量的variablename值。需要注意的是，如果变量是在函数内定义的，那么需要在函数内使用关键字声明变量为全局变量，才能在函数外部通过variablename的值。实例如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$globalVariable</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">updateGlobalVariable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'globalVariable'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">updateGlobalVariable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$globalVariable</span><span class="token punctuation">;</span> <span class="token comment">// 输出 20</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>简单说就是在变量前标记此字符串，我们在这段代码的任何地方都可以访问到。</p>
</li>
<li><p>get_defined_vars()</p>
<p>该函数会返回由所有已定义变量所组成的数组，该函数无需接受任何参数。使用方法如下代码展示所示：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  
<span class="token comment">// Declare an array and initialize it </span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  
<span class="token comment">// Use get_defined_vars() function </span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">get_defined_vars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  
<span class="token comment">// Display the output </span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>输出结果如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">Array</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token constant">_GET</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token keyword">Array</span>
        <span class="token punctuation">(</span>
        <span class="token punctuation">)</span>

    <span class="token punctuation">[</span><span class="token constant">_POST</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token keyword">Array</span>
        <span class="token punctuation">(</span>
        <span class="token punctuation">)</span>

    <span class="token punctuation">[</span><span class="token constant">_COOKIE</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token keyword">Array</span>
        <span class="token punctuation">(</span>
        <span class="token punctuation">)</span>

    <span class="token punctuation">[</span><span class="token constant">_FILES</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token keyword">Array</span>
        <span class="token punctuation">(</span>
        <span class="token punctuation">)</span>

    <span class="token punctuation">[</span>argv<span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token keyword">Array</span>
        <span class="token punctuation">(</span>
            <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token operator">/</span>home<span class="token operator">/</span><span class="token number">9485</span>b6f3bafb5e0e7b2d4580a85e639d<span class="token operator">.</span>php
        <span class="token punctuation">)</span>

    <span class="token punctuation">[</span>argc<span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token number">1</span>
    <span class="token punctuation">[</span><span class="token constant">_SERVER</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token keyword">Array</span>
        <span class="token punctuation">(</span>
            <span class="token punctuation">[</span><span class="token constant">PHP_SELF</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token operator">/</span>home<span class="token operator">/</span><span class="token number">9485</span>b6f3bafb5e0e7b2d4580a85e639d<span class="token operator">.</span>php
            <span class="token punctuation">[</span><span class="token constant">SCRIPT_NAME</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token operator">/</span>home<span class="token operator">/</span><span class="token number">9485</span>b6f3bafb5e0e7b2d4580a85e639d<span class="token operator">.</span>php
            <span class="token punctuation">[</span><span class="token constant">SCRIPT_FILENAME</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token operator">/</span>home<span class="token operator">/</span><span class="token number">9485</span>b6f3bafb5e0e7b2d4580a85e639d<span class="token operator">.</span>php
            <span class="token punctuation">[</span><span class="token constant">PATH_TRANSLATED</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token operator">/</span>home<span class="token operator">/</span><span class="token number">9485</span>b6f3bafb5e0e7b2d4580a85e639d<span class="token operator">.</span>php
            <span class="token punctuation">[</span><span class="token constant">DOCUMENT_ROOT</span><span class="token punctuation">]</span> <span class="token operator">=></span> 
            <span class="token punctuation">[</span><span class="token constant">REQUEST_TIME_FLOAT</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token number">1543316494.2727</span>
            <span class="token punctuation">[</span><span class="token constant">REQUEST_TIME</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token number">1543316494</span>
            <span class="token punctuation">[</span>argv<span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token keyword">Array</span>
                <span class="token punctuation">(</span>
                    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token operator">/</span>home<span class="token operator">/</span><span class="token number">9485</span>b6f3bafb5e0e7b2d4580a85e639d<span class="token operator">.</span>php
                <span class="token punctuation">)</span>

            <span class="token punctuation">[</span>argc<span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token number">1</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token keyword">Array</span>
        <span class="token punctuation">(</span>
            <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token number">0</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token number">1</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token number">2</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token number">3</span>
            <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=></span> <span class="token number">4</span>
        <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>变量命名</p>
<p>PHP变量命名规则：只能包含：字母、数字、下划线，其中，只能以字母、下划线开头：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>php变量命名不允许出现 .（点号）,需要绕过’CTF_SHOW.COM’，GET或POST方式传进去的变量名,会自动将 <strong>空格 + . [</strong> 转换为 <em><strong>*_*</strong></em></p>
<p>特殊字符[, GET或POST方式传参时,变量名中的[也会被替换为_,但其后的字符就不会被替换了。</p>
<pre class="line-numbers language-none"><code class="language-none">CTF[SHOW.COM &#x3D;&gt; CTF_SHOW.COM<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<h2 id="22-Fuzz测试"><a href="#22-Fuzz测试" class="headerlink" title="22.Fuzz测试"></a>22.Fuzz测试</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>is_numeric函数绕过</strong></p>
<p>在本道题目当中，要求num变量为数字且不能为36。绕过方法同上所述。如下为一个小脚本：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span><span class="token number">128</span> <span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token variable">$x</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//输出：%09 、%0A、 %0B、 %0C、 %0D、 +、 %2B、 -、 .（点）、</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>trim()函数绕过</strong></p>
<p>trim() 函数移除字符串两侧的空白字符或其他预定义字符。语法如下：</p>
<p><code>trim(string,charlist)</code></p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">string</td>
<td align="left">必需。规定要检查的字符串。</td>
</tr>
<tr>
<td align="left">charlist</td>
<td align="left">可选。规定从字符串中删除哪些字符。如果被省略，则移除以下所有字符：”\0” - NULL；”\t” - 制表符；”\n” - 换行；”\x0B” - 垂直制表符；”\r” - 回车；” “ - 空格。</td>
</tr>
</tbody></table>
<p><strong>技术细节</strong></p>
<table>
<thead>
<tr>
<th>返回值：</th>
<th>返回被修改的字符串</th>
</tr>
</thead>
<tbody><tr>
<td>PHP 版本：</td>
<td>4+</td>
</tr>
<tr>
<td>更新日志：</td>
<td>在 PHP 4.1 中，新增了 <em>charlist</em> 参数。</td>
</tr>
</tbody></table>
<h2 id="23-assert-断言"><a href="#23-assert-断言" class="headerlink" title="23.assert()断言"></a>23.assert()断言</h2><p>断言是一种在代码中检查预期条件的方法。它用于在程序中插入断点，以确保运行时满足特定的条件或假设。断言通常用于调试和测试阶段，以验证代码的正确性。简单来说就是用于调试，判断其结果是否处错，可以用于命令执行。语法如下：</p>
<p><code>assert(mixed$assertion, Throwable|string|null $description = null): bool</code></p>
<pre class="line-numbers language-none"><code class="language-none">assert() 断言：

PHP 5
bool assert ( mixed $assertion [, string $description ] )

PHP 7
bool assert ( mixed $assertion [, Throwable $exception ] )

如果 assertion 是字符串，它将会被 assert() 当做 PHP 代码来执行
可见，eval和assert都可以将字符当作代码执行，只不过assert不需要严格遵从语法，比如语句末尾的分号可不加
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="24-gettext拓展"><a href="#24-gettext拓展" class="headerlink" title="24.gettext拓展"></a>24.gettext拓展</h2><p>在开启该拓展后 _() 等效于 gettext()</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">echo</span> <span class="token function">gettext</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"phpinfo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
结果  phpinfo
<span class="token keyword">echo</span> <span class="token function">_</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"phpinfo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
结果 phpinfo <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="25-shell-exec-函数"><a href="#25-shell-exec-函数" class="headerlink" title="25.shell_exec()函数"></a>25.shell_exec()函数</h2><p>exec 是 bash 的内置命令，即内部命令；</p>
<p>内部命令就是：内部命令是嵌入在shell解释器中的命令。它们是shell解释器的一部分，可以直接在shell进程中执行，无需创建新的子进程，如：<code>cd</code>、<code>echo</code>、<code>export</code>等命令都是内部命令。</p>
<p>外部命令：外部命令是指存储在磁盘上的可执行程序或脚本文件。它们不是shell本身的一部分，而是独立存在的应用程序。如：在Unix&#x2F;Linux系统中，<code>ls</code>、<code>cp</code>、<code>grep</code>等命令都是外部命令。以下题为例：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$F</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/system|nc|wget|exec|passthru|netcat/i'</span><span class="token punctuation">,</span> <span class="token variable">$F</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们可以输入：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">get传参   <span class="token constant">F</span><span class="token operator">=</span><span class="token string backtick-quoted-string">`$F `</span><span class="token punctuation">;</span>sleep <span class="token number">3</span>
经过<span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>截取后 得到  <span class="token string backtick-quoted-string">`$F `</span><span class="token punctuation">;</span>
也就是会执行 <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"`<span class="token interpolation"><span class="token variable">$F</span></span> `;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
我们把原来的<span class="token variable">$F</span>带进去
<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"``<span class="token interpolation"><span class="token variable">$F</span></span> `;sleep 3`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//``是shell_exec()函数的缩写</span>
前面的命令我们不需要管，但是后面的命令我们可以自由控制。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="26-curl命令"><a href="#26-curl命令" class="headerlink" title="26.curl命令"></a>26.curl命令</h2><p>curl 是常用的命令行工具，用来请求 Web 服务器。详细接介绍使用方法的见：<a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2019/09/curl-reference.html">curl 的用法指南 - 阮一峰的网络日志 </a></p>
<h2 id="27-prase-str-和extract"><a href="#27-prase-str-和extract" class="headerlink" title="27.prase_str()和extract()"></a>27.prase_str()和extract()</h2><ul>
<li><p>prase_str()函数：</p>
<p>parse_str() 函数把查询字符串解析到变量中。注意：如果未设置 array 参数，由该函数设置的变量将覆盖已存在的同名变量，php.ini 文件中的 magic_quotes_gpc 设置影响该函数的输出。如果已启用，那么在 parse_str() 解析之前，变量会被 addslashes() 转换。</p>
<p>语法：<code>parse_str(string,array)</code></p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><em>string</em></td>
<td align="left">必需。规定要解析的字符串。</td>
</tr>
<tr>
<td align="left"><em>array</em></td>
<td align="left">可选。规定存储变量的数组名称。该参数指示变量存储到数组中。</td>
</tr>
</tbody></table>
</li>
<li><p>extract()函数：</p>
<p>extract()：从数组中将变量导入到当前的符号表。</p>
</li>
</ul>
<p>注意区别： extract是将数组中元素分解,执行后数组的key值作为变量名，数组的value赋值给对应Key的变量，这样可以直接通过Key变量去访问，不用数组加key去访问。 即：从数组中创建变量；而parse_str是根据”&#x3D;”来分解字符串，主要用于对url参数的解析。</p>
<h2 id="28-目录穿越漏洞"><a href="#28-目录穿越漏洞" class="headerlink" title="28.目录穿越漏洞"></a>28.目录穿越漏洞</h2><p><strong>漏洞介绍</strong>：</p>
<p>目录遍历（目录穿越）是一个Web安全漏洞，攻击者可以利用该漏洞读取运行应用程序的服务器上的任意文件。 这可能包括应用程序代码和数据，后端系统的登录信息以及敏感的操作系统文件。</p>
<p><strong>漏洞原理</strong>：</p>
<p>在部分情况下，如读取图片时，会用这种方法显示,<code>&lt;img src=&quot;/loadImage?filename=214.png&quot;&gt;</code>,使用filename参数加载图像文件，图片文件位置可能映射在 <code>/var/www/images/ </code>上，所以真实的路径是<code>/var/www/images/214.png</code>,这就导致了攻击者可以读取服务器上的任意文件。</p>
<p><u>在Unix操作系统上，..&#x2F; 是一个标准的返回上一级路径的语法；</p>
<p>在Windows操作系统上， ..&#x2F; 和 ..\ 都是返回上一级的语句。</u></p>
<p><strong>绕过方法</strong>：</p>
<ul>
<li><p>编码绕过：对构造的url进行编码，可以绕过部分对<code>/</code>和<code>.</code>符号的过滤</p>
</li>
<li><p>绝对路径配合绕过：在部分网站中，会检查你是否为绝对路径开头，此时：<br><code>filename=/var/www/images/../../../etc/passwd</code></p>
<p>用<code>/../</code>可以成功绕过，在部分情况下。</p>
</li>
<li><p>截断绕过：通过%00字符，在某写情况下可以绕过对文件后缀的过滤，跟文件上传00截断相差不大。</p>
</li>
<li><p>根据过滤方式绕过：部分过滤情况只会过滤<code>/</code>或者<code>./</code>,再或者过滤<code>../</code>，在这种情况下，我们就可以根据过滤方法来针对绕过。</p>
</li>
</ul>
<p>在特性题目当中，在部分文件读取的情况下可以通过目录穿越绕过，或者伪协议。</p>
<h2 id="29-整型溢出"><a href="#29-整型溢出" class="headerlink" title="29.整型溢出"></a>29.整型溢出</h2><p>整型值可以使用十进制，十六进制，八进制或二进制表示，前面可以加上可选的符号（- 或者 +）。</p>
<p>注意：要使用八进制表达，数字前必须加上 0。要使用十六进制表达，数字前必须加上 0x。要使用二进制表达，数字前必须加上 0b。</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token number">1234</span><span class="token punctuation">;</span> <span class="token comment">// 十进制数</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">;</span> <span class="token comment">// 负数</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token number">0123</span><span class="token punctuation">;</span> <span class="token comment">// 八进制数 (等于十进制 83)</span>
<span class="token variable">$d</span> <span class="token operator">=</span> <span class="token number">0x1A</span><span class="token punctuation">;</span> <span class="token comment">// 十六进制数 (等于十进制 26)</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当在php的代码中存在用int的定义的变量时，如果给定的一个数超出了 integer 的范围，将会被解释为 float。同样如果执行的运算结果超出了 integer 范围，也会返回 float。</p>
<p>对于32位的操作系统，最大的整型是2147483647，即2的31次方，最小为-2的31次方。本次实验环境：PHP 7.2，Ubuntu 14.04。</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token number">123445566</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token number">9223372036854775807</span><span class="token punctuation">;</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token number">9223372036854775808</span><span class="token punctuation">;</span>
<span class="token variable">$d</span> <span class="token operator">=</span> <span class="token number">50000000000000</span> <span class="token operator">*</span> <span class="token number">1000000</span><span class="token punctuation">;</span>

<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>执行得到结果为：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">int</span><span class="token punctuation">(</span><span class="token number">123445566</span><span class="token punctuation">)</span>
<span class="token keyword type-declaration">int</span><span class="token punctuation">(</span><span class="token number">9223372036854775807</span><span class="token punctuation">)</span>
<span class="token keyword type-declaration">float</span><span class="token punctuation">(</span><span class="token number">9.2233720368548E+18</span><span class="token punctuation">)</span>
<span class="token keyword type-declaration">float</span><span class="token punctuation">(</span><span class="token number">5.0E+19</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>在部分的支付界面时，购买数量是用int型定义的，当我们把数量调节到超出范围是，总金额经过运算之后回变为负数。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">阿巴</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2023/07/16/PHP%E7%89%B9%E6%80%A7/">http://example.com/2023/07/16/PHP%E7%89%B9%E6%80%A7/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/web%E5%AE%89%E5%85%A8/">web安全</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/07/20/sql%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="sql注入学习笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">sql注入学习笔记</div></div></a></div><div class="next-post pull-right"><a href="/2023/07/16/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%EF%BC%88SSRF%EF%BC%89%E6%BC%8F%E6%B4%9E/" title="服务器端请求伪造漏洞"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">服务器端请求伪造漏洞</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/07/20/CTFshow_php%E7%89%B9%E6%80%A7/" title="ctfshow__PHP特性"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-20</div><div class="title">ctfshow__PHP特性</div></div></a></div><div><a href="/2023/08/20/Nepctf2023%E5%A4%8D%E7%8E%B0/" title="Nepctf2023复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-20</div><div class="title">Nepctf2023复现</div></div></a></div><div><a href="/2023/08/03/XXE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%EF%BC%89/" title="外部实体注入攻击（XXE）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-03</div><div class="title">外部实体注入攻击（XXE）</div></div></a></div><div><a href="/2023/08/03/ctfshow%E2%80%94%E2%80%94%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="ctfshow__反序列化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-03</div><div class="title">ctfshow__反序列化</div></div></a></div><div><a href="/2023/08/09/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/" title="ssti模板注入"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-09</div><div class="title">ssti模板注入</div></div></a></div><div><a href="/2023/08/20/ctfshow%E2%80%94%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="ctfshow—命令执行"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-20</div><div class="title">ctfshow—命令执行</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">阿巴</div><div class="author-info__description">仰天大笑出门去，我辈岂是蓬蒿人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">65</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP%E7%89%B9%E6%80%A7"><span class="toc-number">1.</span> <span class="toc-text">PHP特性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E5%9F%BA%E6%9C%AC%E5%BC%B1%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">0.基本弱类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%85%83%E5%AD%97%E7%AC%A6"><span class="toc-number">1.2.</span> <span class="toc-text">1.元字符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A8%A1%E5%BC%8F%E4%BF%AE%E6%AD%A3%E7%AC%A6%EF%BC%9A"><span class="toc-number">1.3.</span> <span class="toc-text">2.模式修正符：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-preg-match-%E5%87%BD%E6%95%B0"><span class="toc-number">1.4.</span> <span class="toc-text">3.preg_match()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-intval-%E5%87%BD%E6%95%B0"><span class="toc-number">1.5.</span> <span class="toc-text">4.intval()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-strpos-%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.</span> <span class="toc-text">5.strpos()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-MD5%E5%92%8Csha1-%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.</span> <span class="toc-text">6.MD5和sha1()函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#md5"><span class="toc-number">1.7.1.</span> <span class="toc-text">md5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sha1-%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.2.</span> <span class="toc-text">sha1()函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-file-put-contents-%E5%87%BD%E6%95%B0"><span class="toc-number">1.8.</span> <span class="toc-text">7.file_put_contents()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-in-array-%E5%87%BD%E6%95%B0"><span class="toc-number">1.9.</span> <span class="toc-text">8.in_array()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">1.10.</span> <span class="toc-text">9.优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-ReflectionClass%E5%8F%8D%E5%B0%84%E7%B1%BB"><span class="toc-number">1.11.</span> <span class="toc-text">10.ReflectionClass反射类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-is-numeric-%E5%87%BD%E6%95%B0"><span class="toc-number">1.12.</span> <span class="toc-text">11.is_numeric()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-call-user-func%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">1.13.</span> <span class="toc-text">12.call_user_func回调函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-php%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.14.</span> <span class="toc-text">13.php伪协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-is-file-%E5%87%BD%E6%95%B0"><span class="toc-number">1.15.</span> <span class="toc-text">14.is_file()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-parse-str-%E5%87%BD%E6%95%B0"><span class="toc-number">1.16.</span> <span class="toc-text">15.parse_str()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-ereg-%E6%88%AA%E6%96%AD%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.17.</span> <span class="toc-text">16.ereg()截断漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-strrev-%E5%87%BD%E6%95%B0"><span class="toc-number">1.18.</span> <span class="toc-text">17.strrev()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96%E7%BB%95%E8%BF%87"><span class="toc-number">1.19.</span> <span class="toc-text">18.变量覆盖绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-Exception%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E7%B1%BB"><span class="toc-number">1.20.</span> <span class="toc-text">19.Exception异常处理类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-FilesystemIterator%E7%B1%BB%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-number">1.21.</span> <span class="toc-text">20.FilesystemIterator类读取文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-php%E5%8F%98%E9%87%8F"><span class="toc-number">1.22.</span> <span class="toc-text">21.php变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-Fuzz%E6%B5%8B%E8%AF%95"><span class="toc-number">1.23.</span> <span class="toc-text">22.Fuzz测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-assert-%E6%96%AD%E8%A8%80"><span class="toc-number">1.24.</span> <span class="toc-text">23.assert()断言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-gettext%E6%8B%93%E5%B1%95"><span class="toc-number">1.25.</span> <span class="toc-text">24.gettext拓展</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-shell-exec-%E5%87%BD%E6%95%B0"><span class="toc-number">1.26.</span> <span class="toc-text">25.shell_exec()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-curl%E5%91%BD%E4%BB%A4"><span class="toc-number">1.27.</span> <span class="toc-text">26.curl命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#27-prase-str-%E5%92%8Cextract"><span class="toc-number">1.28.</span> <span class="toc-text">27.prase_str()和extract()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#28-%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.29.</span> <span class="toc-text">28.目录穿越漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#29-%E6%95%B4%E5%9E%8B%E6%BA%A2%E5%87%BA"><span class="toc-number">1.30.</span> <span class="toc-text">29.整型溢出</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/18/Python%E4%B8%AD%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC/" title="Python中的内存马">Python中的内存马</a><time datetime="2024-09-17T16:00:00.000Z" title="Created 2024-09-18 00:00:00">2024-09-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/27/JNDI%20-(%E5%8F%AF%E8%AE%BF%E9%97%AE)JDBC%E3%80%81LDAP%E3%80%81RMI%E3%80%81DNS%E3%80%81NIS%E3%80%81CORBA%E3%80%82/" title="Untitled">Untitled</a><time datetime="2024-06-27T13:08:05.623Z" title="Created 2024-06-27 21:08:05">2024-06-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/16/http192.168.1.14410003/" title="Untitled">Untitled</a><time datetime="2024-06-16T11:39:32.205Z" title="Created 2024-06-16 19:39:32">2024-06-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/01/%E7%9F%A9%E9%98%B5%E6%9D%AFwp/" title="Untitled">Untitled</a><time datetime="2024-06-01T06:19:50.358Z" title="Created 2024-06-01 14:19:50">2024-06-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/05/26/Docker%20%20PHP%E7%9A%84%E8%A3%B8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" title="Untitled">Untitled</a><time datetime="2024-05-26T08:06:29.598Z" title="Created 2024-05-26 16:06:29">2024-05-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 阿巴</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>